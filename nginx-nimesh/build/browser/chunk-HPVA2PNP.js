import{a as R}from"./chunk-Z4PJH56D.js";import{a as V}from"./chunk-X77UPS6A.js";import{a as F}from"./chunk-3FV7DAM6.js";import{a as O}from"./chunk-ALJ75YVM.js";import{a as L}from"./chunk-M5AHF4UO.js";import{a as j}from"./chunk-CI6T4FGN.js";import"./chunk-RHLCCWT6.js";import"./chunk-YEGTZ3HQ.js";import"./chunk-5RBAZJQA.js";import{b as B,c as C}from"./chunk-PNSBUHWU.js";import"./chunk-GXFYRQIF.js";import{b as P,d as D}from"./chunk-DJWEABC6.js";import{i as w,j as T,q as k,r as M}from"./chunk-MZLVPJ5Q.js";import{Bc as i,Cc as u,Db as N,Dc as p,Kb as f,Qc as b,Sc as h,Tb as v,ca as I,cc as t,dc as e,ea as _,ec as a,m as E,nb as l,oa as x,ob as c,oc as y,qc as A}from"./chunk-2GFQMTJ2.js";function q(m,g){if(m&1&&(t(0,"tr")(1,"td",27),i(2),e(),t(3,"td",28),i(4),b(5,"currency"),e(),a(6,"td",30),e()),m&2){let o=g.$implicit;l(2),p(" ",o.descriptions," "),l(2),p(" ",h(5,2,o.amount," ")," ")}}function U(m,g){if(m&1&&(t(0,"tr"),a(1,"td",27),t(2,"td",28)(3,"span",29),i(4,"DUE AMOUNT :"),e(),i(5),b(6,"currency"),e(),a(7,"td",30),e()),m&2){let o=A();l(5),p(" ",h(6,1,o.dueAmount," ")," ")}}var Y=(()=>{class m{constructor(o,n,r,s,d,S){this._estimateService=o,this._estimateTreatmentService=n,this._vatService=r,this._invoicePaymentsService=s,this._invoiceService=d,this._invoiceItemService=S,this._unsubscribeAll=new E,this._route=x(P),this.vehicleEstimateTreatments=[],this.totalAmount=0,this.netTotalAmount=0,this.invoiceDate="",this.insurance="",this.invNo="",this.vehicleModel="",this.router=x(D),this.invoicePayments=[],this.totalPaidAmount=0,this.dueAmount=null}ngOnInit(){let o=this._route.snapshot.paramMap.get("id");o&&this._invoiceService.find(Number(o)).pipe(I(this._unsubscribeAll),_(n=>{n.body&&(this.getAllPayments(Number(o)),this.invoiceDetails=n.body,this.ownerName=n.body.vehicleOwnerName,this.invNo=n.body.invoiceNumber,this.customerVATNumber=n.body.customerVATNumber,this.vehicleLicenseNumber=n.body.vehicleLicenseNumber,this.vehicleModel=n.body.vehicleModel,this.insurance=n.body.insuranceName,this.totalAmount=n.body.totalAmount,this.netTotalAmount=n.body.netTotalAmount,this.invoiceDate=n.body.invoiceDate.format("YYYY-MM-DD"),this._invoiceItemService.query({"invoiceId.equals":`${n.body.id}`}).subscribe(r=>{let s=r.body||[];this.vehicleEstimateTreatments=s.map(d=>({id:d.id,descriptions:d.descriptions,amount:d.amount,types:d.types})),console.log("\u{1F6E0}\uFE0F Job Item Time Estimations:",this.vehicleEstimateTreatments)}))})).subscribe()}getAllPayments(o){let n={size:1e3,"invoiceId.equals":o};this._invoicePaymentsService.query(n).subscribe(r=>{this.invoicePayments=r.body||[],this.totalPaidAmount=this.invoicePayments.reduce((s,d)=>s+(d.amount||0),0),this.dueAmount=Math.max(this.totalAmount-this.totalPaidAmount,0)})}print(){window.print()}goBack(){let o=this.invoiceDetails.id;this.router.navigate(["/invoices-view/",o])}static{this.\u0275fac=function(n){return new(n||m)(c(j),c(L),c(R),c(V),c(O),c(F))}}static{this.\u0275cmp=N({type:m,selectors:[["app-bill-n"]],decls:80,vars:16,consts:[["cdkScrollable","",1,"absolute","inset-0","min-w-0","overflow-auto","text-center","print:overflow-visible"],[1,"inline-block","p-6","text-left","sm:p-10","print:p-0"],[1,"flex","space-x-4","mb-6","print:hidden"],[1,"px-4","py-2","bg-gradient-to-r","from-gray-500","to-gray-700","hover:from-gray-600","hover:to-gray-800","rounded-lg","shadow","text-white","flex","items-center","transition-all","duration-200",3,"click"],[1,"icon-size-4","text-white",3,"svgIcon"],[1,"ml-2"],[1,"px-4","py-2","bg-gradient-to-r","from-rose-500","to-red-500","hover:from-rose-600","hover:to-red-600","rounded-lg","shadow","text-white","flex","items-center","transition-all","duration-200",3,"click"],[1,"bg-card","w-240","rounded-2xl","p-16","shadow","print:w-auto","print:rounded-none","print:bg-transparent","print:shadow-none"],[1,"text-right","text-4xl","font-bold","text-primary"],[1,"text-primaryt"],[1,"text-lg","font-bold"],[1,"text-sm","font-bold"],[1,"bill-meta","mt-4","text-sm","grid","grid-cols-2","gap-4"],[1,"mb-2","flex","text-xl"],[1,"w-40","ml-3"],[1,"mb-2","flex"],[1,"border-b","border-dotted","border-black","w-40","ml-3"],[1,"text-center"],[1,"mb-2","flex","justify-end","items-end"],[1,"col-span-6","my-4"],[1,"col-span-6","my-8","border-b-4"],[1,"w-full","table-auto","border-collapse","border","border-black","text-sm"],[1,"bg-gray-100"],[1,"border","border-black","px-4","py-2","text-left","font-bold"],[1,"border","border-black","px-4","py-2","text-right","font-bold"],[1,"border","border-black","px-1","py-2","text-right","font-bold"],[4,"ngFor","ngForOf"],[1,"border","border-black","px-4","py-2"],[1,"border","border-black","px-4","py-2","text-right"],[1,"font-bold"],[1,"border","border-black","px-1","py-2","text-right"],[4,"ngIf"]],template:function(n,r){n&1&&(t(0,"div",0)(1,"div",1)(2,"div",2)(3,"button",3),y("click",function(){return r.goBack()}),a(4,"mat-icon",4),t(5,"span",5),i(6,"Back"),e()(),t(7,"button",6),y("click",function(){return r.print()}),a(8,"mat-icon",4),t(9,"span",5),i(10,"Print"),e()()(),t(11,"div",7)(12,"div",8)(13,"div",9),i(14,"Nimesh Motor Works (PVT) LTD"),e(),t(15,"div",10),i(16," Repairs to all Diesel & Petrol Motor Vehicles, Tinkering & Painting "),e(),t(17,"div",11),i(18," No: 25, Jubile Rd, Laxapathiya, Moratuwa "),e(),t(19,"div",11),i(20,"Tel: 071 421 8718 / 077 782 5161"),e(),t(21,"div",11),i(22,"E-mail: nimeshmotorw@gmail.com"),e()(),t(23,"section",12)(24,"div")(25,"div",13)(26,"strong"),i(27,"INV NO: "),e(),a(28,"br"),t(29,"span",14),i(30),e()(),t(31,"div",15)(32,"strong"),i(33,"Vehicle No: "),e(),a(34,"br"),t(35,"span",16),i(36),e()(),t(37,"div",15)(38,"strong"),i(39,"Mr/Mrs: "),e(),a(40,"br"),t(41,"span",16),i(42),e()()(),t(43,"div",17)(44,"div",18)(45,"strong"),i(46,"Date:"),e(),a(47,"br"),t(48,"span",16),i(49),e()()()(),a(50,"div",19)(51,"div",20),t(52,"table",21)(53,"thead")(54,"tr",22)(55,"th",23),i(56," Description "),e(),t(57,"th",24),i(58," Rs. "),e(),t(59,"th",25),i(60," Cts. "),e()()(),t(61,"tbody"),f(62,q,7,5,"tr",26),t(63,"tr"),a(64,"td",27),t(65,"td",28)(66,"span",29),i(67,"TOTAL :"),e(),i(68),b(69,"currency"),e(),a(70,"td",30),e(),t(71,"tr"),a(72,"td",27),t(73,"td",28)(74,"span",29),i(75,"TOTAL PAYED :"),e(),i(76),b(77,"currency"),e(),a(78,"td",30),e(),f(79,U,8,4,"tr",31),e()()()()()),n&2&&(l(4),v("svgIcon","mat_outline:arrow_back"),l(4),v("svgIcon","mat_outline:print"),l(22),u(r.invNo),l(6),u(r.vehicleLicenseNumber),l(6),u(r.ownerName),l(7),u(r.invoiceDate),l(13),v("ngForOf",r.vehicleEstimateTreatments),l(6),p(" ",h(69,10,r.totalAmount," ")," "),l(8),p(" ",h(77,13,r.totalPaidAmount," ")," "),l(3),v("ngIf",r.dueAmount))},dependencies:[M,w,T,k,C,B],encapsulation:2})}}return m})();var le=[{path:"",component:Y}];export{le as default};
