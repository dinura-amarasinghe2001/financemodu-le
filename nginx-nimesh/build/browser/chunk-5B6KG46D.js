import{a as we}from"./chunk-2BGIWFS4.js";import{a as Fe,b as Be}from"./chunk-JCUL3757.js";import{a as ye,b as Me,c as Ie,d as Ee,e as Ne,f as _e}from"./chunk-R44K775J.js";import{a as ke}from"./chunk-PH6QFVW6.js";import{b as ve}from"./chunk-T73PE35A.js";import{b as Se,c as y}from"./chunk-YEGTZ3HQ.js";import{a as ue,c as ce,d as fe}from"./chunk-4WAQRQWE.js";import{a as ge,b as Ce}from"./chunk-HLRQKUHW.js";import{a as xe}from"./chunk-5RBAZJQA.js";import{A as ae,B as le,G as me,H as pe,J as se,K as de,O as he,P as be,b as K,i as Q,j as X,l as ie,n as s,q as ne,r as re,x as oe}from"./chunk-MXRUEL7B.js";import{c as te}from"./chunk-PNSBUHWU.js";import{a as Z,b as J}from"./chunk-TEYA6QDP.js";import{a as Y,d as ee}from"./chunk-VPJKTFM7.js";import{fa as W,ia as H}from"./chunk-GXFYRQIF.js";import{i as $,m as j,r as z,w as G,y as L}from"./chunk-MZLVPJ5Q.js";import{Aa as g,Ac as O,Bc as r,Db as A,Dc as T,Fc as V,Gc as q,Hc as D,K as N,Kb as x,M as _,Qc as R,R as w,Rc as U,Tb as u,a as v,ba as F,cc as n,dc as t,ec as a,ia as B,ic as P,nb as p,oa as c,ob as C,oc as k,p as M,r as I,y as E,za as b}from"./chunk-2GFQMTJ2.js";var Ae=(()=>{class l{constructor(){this.http=c(L),this.applicationConfigService=c(xe),this.resourceUrl=this.applicationConfigService.getEndpointFor("api/banks","inventorymicro"),this.resourceSearchUrl=this.applicationConfigService.getEndpointFor("api/banks/_search","inventorymicro")}create(e){return this.http.post(this.resourceUrl,e,{observe:"response"})}update(e){return this.http.put(`${this.resourceUrl}/${this.getBankIdentifier(e)}`,e,{observe:"response"})}partialUpdate(e){return this.http.patch(`${this.resourceUrl}/${this.getBankIdentifier(e)}`,e,{observe:"response"})}find(e){return this.http.get(`${this.resourceUrl}/${e}`,{observe:"response"})}query(e){let i=y(e);return this.http.get(this.resourceUrl,{params:i,observe:"response"})}delete(e){return this.http.delete(`${this.resourceUrl}/${e}`,{observe:"response"})}search(e){let i=y(e);return this.http.get(this.resourceSearchUrl,{params:i,observe:"response"}).pipe(N(()=>I([new G],M)))}getBankIdentifier(e){return e.id}compareBank(e,i){return e&&i?this.getBankIdentifier(e)===this.getBankIdentifier(i):e===i}addBankToCollectionIfMissing(e,...i){let o=i.filter(Se);if(o.length>0){let m=e.map(d=>this.getBankIdentifier(d));return[...o.filter(d=>{let h=this.getBankIdentifier(d);return m.includes(h)?!1:(m.push(h),!0)}),...e]}return e}static{this.\u0275fac=function(i){return new(i||l)}}static{this.\u0275prov=B({token:l,factory:l.\u0275fac,providedIn:"root"})}}return l})();function Te(l,S){l&1&&r(0,"General Information")}function Ve(l,S){l&1&&r(0,"Bank Information")}function qe(l,S){if(l&1&&(n(0,"mat-option",43),r(1),t()),l&2){let e=S.$implicit;u("value",e.name),p(),T(" ",e.name," ")}}var Mt=(()=>{class l{constructor(e,i,o){this.fb=e,this.dialogRef=i,this.data=o,this.suplierprof=c(ke),this.supplierbank=c(Fe),this.supplierbankdetails=c(Be),this.bank=c(Ae),this.activeTabIndex=0,this.generalForm=this.fb.group({name:["",s.required],code:[null,s.required],addressOffice:[null],cityOffice:[null],addressFactory:[null],cityFactory:[null],phone1:[null,[s.required,s.pattern(/^\d{10}$/)]],fax:[null],email:[null,s.email],website:[null],contactPersonName:[null],contactPersonMobile:[null,s.pattern(/^\d{10}$/)],brNumber:[null],vatRegNumber:[null],tinNumber:[null],isVATEnable:[!1],isNBTEnable:[!1]}),this.bankForm=this.fb.group({creditPeriod:[null,s.required],bankAccountName:[null,s.required],bankAccountNumber:[null,s.required],bankName:[null,s.required],bankBranch:[null],maximumCreditLimit:[null],chequeDrawn:[null]})}ngOnInit(){this.filteredBanks=this.bankForm.get("bankName").valueChanges.pipe(_(300),w(),F(e=>this.fetchBanksFromApi(e||""))),this.data?.supplier&&(this.generalForm.patchValue(this.data.supplier),this.bankForm.patchValue(this.data.supplier)),this.fetchSupCode()}fetchBanksFromApi(e){return this.bank.query({"name.contains":e}).pipe(E(i=>i.body||[]))}displayBankName(e){return e}fetchSupCode(){let e={sort:["id,desc"],size:1};this.suplierprof.query(e).subscribe({next:i=>{let o=i.body||[];if(o.length===0){this.generalForm.patchValue({code:"sup001"});return}let m=o[0].code||"sup001",f=m.match(/[A-Za-z]+/)?.[0]||"sup",h=((parseInt(m.replace(/\D/g,""),10)||0)+1).toString().padStart(3,"0"),Pe=`${f}${h}`;this.generalForm.patchValue({code:Pe})},error:i=>{console.error("Error fetching supplier code:",i),this.generalForm.patchValue({code:"sup001"})}})}supplierbanksave(e){let i=this.bankForm.value,o=v({maximumDiscount:e},i);this.supplierbank.create(o).subscribe({next:m=>{console.log(m.body)}})}supplierbankaccount(e){console.log("im workinggggggggggggggggggggg");let i=this.bankForm.value;console.log(i);let o=v({bankId:e},i);this.supplierbankdetails.create(o).subscribe({next:m=>{console.log(m.body)}})}onStepChange(e){e.selectedIndex===1?this.dialogRef.updateSize("80vh","69vh"):this.dialogRef.updateSize("80vh","95vh")}save(){if(this.generalForm.valid){let e=this.generalForm.value;console.log("Saving supplier:",e),this.suplierprof.create(e).subscribe({next:i=>{console.log("Supplier created successfully:",i),this.supplierbanksave(i.body.id),this.supplierbankaccount(i.body.id),this.dialogRef.close(e)},error:i=>{console.error("Error creating supplier:",i)}})}else console.warn("General form is invalid")}static{this.\u0275fac=function(i){return new(i||l)(C(pe),C(Z),C(J))}}static{this.\u0275cmp=A({type:l,selectors:[["app-supplier-create"]],decls:116,vars:11,consts:[["autoBank","matAutocomplete"],[1,"stepper-container"],["linear","",3,"selectedIndexChange","selectionChange","selectedIndex"],[3,"stepControl"],[3,"formGroup"],["matStepLabel",""],[1,"form-section"],[1,"form-row"],["appearance","outline",1,"form-field"],["matInput","","required","","formControlName","name"],["matInput","","required","","formControlName","code","readonly",""],[1,"address-block"],["appearance","outline"],["matInput","","placeholder","Address","formControlName","addressOffice"],["matInput","","placeholder","Address","formControlName","addressFactory"],["matInput","","formControlName","phone1"],["matInput","","formControlName","fax"],["matInput","","type","email","formControlName","email"],["matInput","","formControlName","website"],["matInput","","formControlName","contactPersonName"],["matInput","","formControlName","contactPersonMobile"],[1,"form-row","align-items-center"],["matInput","","formControlName","vatRegNumber"],["formControlName","isVATEnable"],["matInput","","formControlName","brNumber"],["matInput","","formControlName","tinNumber"],[1,"button-right"],["mat-raised-button","","color","primary","matStepperNext","",3,"disabled"],[1,"form-grid"],["appearance","outline",1,"w-full"],["matInput","","formControlName","creditPeriod"],["matInput","","formControlName","bankAccountName"],["matInput","","formControlName","bankAccountNumber"],["type","text","matInput","","formControlName","bankName","placeholder","Type or select a bank",3,"matAutocomplete"],[3,"displayWith"],[3,"value",4,"ngFor","ngForOf"],["matInput","","formControlName","bankBranch","placeholder","Enter branch"],["matInput","","formControlName","maximumCreditLimit"],["appearance","outline",1,"full-width"],["matInput","","rows","4","formControlName","chequeDrawn"],[1,"button-row","space-between"],["mat-button","","matStepperPrevious",""],["mat-raised-button","","color","primary",3,"click"],[3,"value"]],template:function(i,o){if(i&1){let m=P();n(0,"div",1)(1,"mat-horizontal-stepper",2),D("selectedIndexChange",function(d){return b(m),q(o.activeTabIndex,d)||(o.activeTabIndex=d),g(d)}),k("selectionChange",function(d){return b(m),g(o.onStepChange(d))}),n(2,"mat-step",3)(3,"form",4),x(4,Te,1,0,"ng-template",5),n(5,"fieldset")(6,"div",6),a(7,"br"),n(8,"div",7)(9,"mat-form-field",8)(10,"mat-label"),r(11,"Supplier Name*"),t(),a(12,"input",9),t(),n(13,"mat-form-field",8)(14,"mat-label"),r(15,"Supplier Code*"),t(),a(16,"input",10),t()(),n(17,"div",7)(18,"div",11)(19,"mat-label"),r(20,"Address (Head Office)*"),t(),n(21,"mat-form-field",12),a(22,"input",13),t()(),n(23,"div",11)(24,"mat-label"),r(25,"Address (Factory)"),t(),n(26,"mat-form-field",12),a(27,"input",14),t()()(),n(28,"div",7)(29,"mat-form-field",8)(30,"mat-label"),r(31,"Tel No*"),t(),a(32,"input",15),t(),n(33,"mat-form-field",8)(34,"mat-label"),r(35,"Fax"),t(),a(36,"input",16),t(),n(37,"mat-form-field",8)(38,"mat-label"),r(39,"Email"),t(),a(40,"input",17),t(),n(41,"mat-form-field",8)(42,"mat-label"),r(43,"Web"),t(),a(44,"input",18),t()(),n(45,"div",7)(46,"mat-form-field",8)(47,"mat-label"),r(48,"Contact Person"),t(),a(49,"input",19),t(),n(50,"mat-form-field",8)(51,"mat-label"),r(52,"Mobile Tel"),t(),a(53,"input",20),t()(),n(54,"div",21)(55,"mat-form-field",8)(56,"mat-label"),r(57,"VAT Reg. Number"),t(),a(58,"input",22),t(),n(59,"mat-checkbox",23),r(60,"VAT registered suppliers"),t()(),n(61,"div",7)(62,"mat-form-field",8)(63,"mat-label"),r(64,"B.R Number"),t(),a(65,"input",24),t(),n(66,"mat-form-field",8)(67,"mat-label"),r(68,"Tin Number"),t(),a(69,"input",25),t()(),n(70,"div",26)(71,"button",27),r(72," Continue "),t()()()()()(),n(73,"mat-step",3)(74,"form",4),x(75,Ve,1,0,"ng-template",5),a(76,"br"),n(77,"fieldset")(78,"div",28)(79,"mat-form-field",29)(80,"mat-label"),r(81,"Credit Period (days)"),t(),a(82,"input",30),t(),n(83,"mat-form-field",29)(84,"mat-label"),r(85,"Account Name"),t(),a(86,"input",31),t(),n(87,"mat-form-field",12)(88,"mat-label"),r(89,"Account No"),t(),a(90,"input",32),t(),n(91,"mat-form-field",29)(92,"mat-label"),r(93,"Bank"),t(),a(94,"input",33),n(95,"mat-autocomplete",34,0),x(97,qe,2,2,"mat-option",35),R(98,"async"),t()(),n(99,"mat-form-field",12)(100,"mat-label"),r(101,"Branch"),t(),a(102,"input",36),t(),n(103,"mat-form-field",12)(104,"mat-label"),r(105,"Maximum Credit Limit"),t(),a(106,"input",37),t(),n(107,"mat-form-field",38)(108,"mat-label"),r(109,"Cheque Should be Drawn"),t(),a(110,"textarea",39),t()(),n(111,"div",40)(112,"button",41),r(113,"Back"),t(),n(114,"button",42),k("click",function(){return b(m),g(o.save())}),r(115,"Save"),t()()()()()()()}if(i&2){let m=O(96);p(),V("selectedIndex",o.activeTabIndex),p(),u("stepControl",o.generalForm),p(),u("formGroup",o.generalForm),p(68),u("disabled",o.generalForm.invalid),p(2),u("stepControl",o.bankForm),p(),u("formGroup",o.bankForm),p(20),u("matAutocomplete",m),p(),u("displayWith",o.displayBankName),p(2),u("ngForOf",U(98,9,o.filteredBanks))}},dependencies:[z,$,j,te,se,oe,ie,ne,re,me,de,ae,le,_e,Me,ye,Ie,Ee,Ne,X,Q,K,be,he,ve,W,H,ee,Y,Ce,ge,we,fe,ue,ce],styles:[".button-right[_ngcontent-%COMP%]{text-align:right;margin-top:16px}mat-form-field[_ngcontent-%COMP%]{min-width:0!important}",".stepper-container[_ngcontent-%COMP%]{height:100vh;display:flex;flex-direction:column}mat-horizontal-stepper[_ngcontent-%COMP%]{flex:1 1 auto;display:flex;flex-direction:column;overflow:hidden}.step-content[_ngcontent-%COMP%]{flex:1 1 auto;overflow-y:auto;padding:16px;display:flex;flex-direction:column}fieldset[_ngcontent-%COMP%]{border:none;padding:0;margin:0;flex:1 1 auto;display:flex;flex-direction:column}.form-section[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:16px;flex:1 1 auto}.form-row[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:16px}.form-field[_ngcontent-%COMP%]{flex:1 1 45%}.address-block[_ngcontent-%COMP%]{flex:1 1 45%;display:flex;flex-direction:column;gap:8px}.align-items-center[_ngcontent-%COMP%]{align-items:center}.button-row[_ngcontent-%COMP%], .fixed-button-row[_ngcontent-%COMP%]{position:sticky;bottom:0;background:#fff;padding:16px 0;display:flex;justify-content:flex-end;z-index:100;border-top:1px solid #ddd;gap:8px}.button-row.space-between[_ngcontent-%COMP%]{justify-content:space-between}.form-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(250px,1fr));gap:16px}.full-width[_ngcontent-%COMP%]{grid-column:span 2}"]})}}return l})();export{Mt as a};
