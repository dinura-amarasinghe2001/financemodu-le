import{a as Te,b as ke}from"./chunk-3NQFVCM6.js";import{a as k}from"./chunk-NMZNR4LF.js";import{a as me}from"./chunk-VQIWVYPK.js";import{c as De}from"./chunk-XGCX3TDA.js";import{a as ue,b as he,c as ge,d as _e,e as be,f as Ce,g as Se,h as ve,i as xe,j as Be,k as ye,l as Me}from"./chunk-4HPTI4QK.js";import{a as ce,b as pe,c as fe}from"./chunk-Z5CSESBH.js";import{a as M,b as we}from"./chunk-4IV6I57G.js";import{b as Ie}from"./chunk-T73PE35A.js";import{h as Ee}from"./chunk-ZGGKBBB7.js";import{a as de}from"./chunk-E4TC4E2W.js";import{a as T}from"./chunk-YEGTZ3HQ.js";import{a as ee}from"./chunk-QQNGDF4M.js";import"./chunk-YK5MGRE7.js";import"./chunk-OT3AQSDR.js";import"./chunk-HN3GTZ22.js";import"./chunk-2V7PXVXU.js";import"./chunk-4WAQRQWE.js";import"./chunk-KKTU7MAV.js";import"./chunk-5RBAZJQA.js";import{J as oe,K as re,O as le,P as se,d as O,i as W,j as G,l as te,q as ie,u as ne,z as ae}from"./chunk-MXRUEL7B.js";import{b as Y,c as Z}from"./chunk-PNSBUHWU.js";import{c as Q,g as L}from"./chunk-TEYA6QDP.js";import"./chunk-JTAP5U5F.js";import{a as J,d as K}from"./chunk-VPJKTFM7.js";import"./chunk-GXFYRQIF.js";import"./chunk-T4I3R2GV.js";import{j as q,r as U}from"./chunk-MZLVPJ5Q.js";import{Aa as _,Ac as E,Bc as c,Cc as X,Db as z,Dc as v,Jc as $,Kb as u,L as R,S as F,Tb as d,V as N,cc as r,dc as s,ec as p,fc as b,gc as C,ic as I,nb as l,oa as V,ob as y,oc as S,qc as w,s as P,uc as H,vc as j,wc as A,za as g}from"./chunk-2GFQMTJ2.js";var Re=()=>[5,10,20];function Fe(e,m){e&1&&p(0,"mat-icon",33),e&2&&d("svgIcon","heroicons_outline:plus")}function Ne(e,m){e&1&&p(0,"mat-spinner",34)}function Ve(e,m){e&1&&(r(0,"th",35),c(1," ID "),s())}function ze(e,m){if(e&1&&(r(0,"td",36),c(1),s()),e&2){let i=m.$implicit;l(),v(" ",i.id," ")}}function He(e,m){e&1&&(r(0,"th",35),c(1," Brand Name "),s())}function je(e,m){if(e&1&&(r(0,"td",36),c(1),s()),e&2){let i=m.$implicit;l(),v(" ",i.brandName," ")}}function Ae(e,m){e&1&&(r(0,"th",35),c(1," Descriotion "),s())}function Xe(e,m){if(e&1&&(r(0,"td",36),c(1),s()),e&2){let i=m.$implicit;l(),v(" ",i.description," ")}}function $e(e,m){e&1&&(r(0,"th",35),c(1," Emblem "),s())}function qe(e,m){if(e&1&&(r(0,"td",36),c(1),s()),e&2){let i=m.$implicit;l(),v(" ",i.emblem," ")}}function Ue(e,m){e&1&&p(0,"th",37)}function Qe(e,m){if(e&1){let i=I();r(0,"td",36)(1,"button",38),S("click",function(){let t=g(i).$implicit,o=w();return _(o.openBrandEditDialog(t))}),c(2," Update "),s(),r(3,"button",39),S("click",function(){let t=g(i).$implicit,o=w();return _(o.deleteBrand(t))}),c(4," Delete "),s()()}}function Le(e,m){e&1&&p(0,"tr",40)}function Oe(e,m){e&1&&p(0,"tr",41)}var Pe=(()=>{class e{constructor(i,n,t){this._brandService=i,this._dialogService=n,this._snackBarService=t,this.dataSource=new Me,this.searchInputControl=new ne,this.allBrandDetails=[],this.noRecord=!1,this.isImporting=!1,this.displayedColumns=["id","brandName","action"],this.itemsPerPage=10,this.totalItems=0,this.page=1,this._fuseConfirmationService=V(ee),this.searchInputControl.valueChanges.subscribe(o=>{this.page=0,this.searchbrand()})}ngOnInit(){this.getallBrandDetails()}ngAfterViewInit(){this._paginator.page.subscribe(()=>{this.page=this._paginator.pageIndex+1,this.itemsPerPage=this._paginator.pageSize,this.getallBrandDetails()})}getallBrandDetails(){let i={page:this.page-1,size:this.itemsPerPage};this._brandService.query(i).subscribe(n=>{n.body?(this.dataSource.data=n.body,this.totalItems=Number(n.headers.get("X-Total-Count"))):this.dataSource.data=[],this.noRecord=this.dataSource.data.length===0})}searchbrand(){let i=this.searchInputControl.value?.trim();if(!i){this.getallBrandDetails();return}let n={page:this.page,size:this.itemsPerPage,"brandName.contains":i};this._brandService.query(n).subscribe(t=>{this.totalItems=Number(t.headers.get("X-Total-Count")),this.dataSource.data=t.body||[],this.noRecord=this.dataSource.data.length===0})}openBrandEditDialog(i){this._dialogService.open(k,{width:"80vh",maxHeight:"90vh",data:{brand:i}}).afterClosed().subscribe(t=>{t&&(this._snackBarService.open("Brand Updated Successfully!","Close",{duration:3e3}),this.getallBrandDetails())})}deleteBrand(i){this._fuseConfirmationService.open({title:"Delete Brand",message:"Are you sure you want to delete this brand? This action cannot be undone!",icon:{name:"heroicons_outline:exclamation-triangle",color:"warn"},actions:{confirm:{label:"Delete",color:"warn"}}}).afterClosed().subscribe(t=>{t==="confirmed"&&this._brandService.delete(i.id).subscribe(()=>{this.getallBrandDetails()})})}openBrandCreateDialog(){this._dialogService.open(k,{width:"80vh",maxHeight:"90vh"}).afterClosed().subscribe(n=>{n&&(this._snackBarService.open("Brand Created Successfully!","Close",{duration:3e3}),this.getallBrandDetails())})}onFileUpload(i,n){let t=i.target.files[0];if(!t){console.warn("No file selected.");return}this.isImporting=!0;let o=new FileReader;o.onload=h=>{let f=new Uint8Array(h.target.result),a=Te(f,{type:"array"}),x=a.SheetNames[0],B=a.Sheets[x],D=ke.sheet_to_json(B);console.log("Parsed Excel Data:",D),this.importBrandFromExcel(D),n.value=""},o.onerror=()=>{console.error("Error reading file"),this.isImporting=!1,n.value=""},o.readAsArrayBuffer(t)}importBrandFromExcel(i){if(!i.length){console.warn("No data to import.");return}this.isImporting=!0;let n=[...new Set(i.map(o=>o.id).filter(Boolean))],t={page:this.page,size:this.itemsPerPage};n.length&&(t["id.in"]=n.join(",")),console.log("Query Parameters:",t),this._brandService.query(t).subscribe(o=>{let h=o.body||[];console.log("Found existingBrands:",h);let f=new Map;h.forEach(a=>{a.id&&f.set(a.id,a)}),P(i).pipe(R(a=>{let x=f.has(a.id),B={id:x?a.id:null,brandName:a.brandName??null,description:a.description??null,opsUnitID:a.opsUnitID??null,emblem:a.emblem??null,createdBy:a.createdBy??null,createdDate:a.createdDate?T(a.createdDate):null,lastModifiedBy:a.lastModifiedBy??null,lastModifiedDate:a.lastModifiedDate?T(a.lastModifiedDate):null};return x?this._brandService.update(B):this._brandService.create(B)}),N(),F(()=>{this.isImporting=!1,console.log("Brand import completed."),this.getallBrandDetails()})).subscribe()})}static{this.\u0275fac=function(n){return new(n||e)(y(me),y(Q),y(de))}}static{this.\u0275cmp=z({type:e,selectors:[["app-brands"]],viewQuery:function(n,t){if(n&1&&H(M,5),n&2){let o;j(o=A())&&(t._paginator=o.first)}},decls:44,vars:18,consts:[["fileInput",""],["paginator",""],[1,"absolute","inset-0","flex","min-w-0","flex-col","overflow-hidden"],[1,"bg-default","flex","flex-0","flex-col","p-6","pb-22","dark:bg-transparent","sm:flex-row","sm:items-center","sm:justify-between","sm:px-10","sm:pb-28","sm:pt-12"],[1,"min-w-0","flex-1"],[1,"mt-2"],[1,"truncate","text-3xl","font-extrabold","leading-7","tracking-tight","sm:leading-10","md:text-4xl"],[1,"mt-6","flex","shrink-0","items-center","sm:ml-4","sm:mt-0"],[1,"fuse-mat-dense","fuse-mat-rounded","min-w-64",3,"subscriptSizing"],["matPrefix","",1,"icon-size-5",3,"svgIcon"],["matInput","",3,"formControl","autocomplete","placeholder"],["mat-flat-button","",1,"ml-3",3,"click","color"],[1,"icon-size-4",3,"svgIcon"],[1,"ml-2"],[1,"relative","ml-2"],["type","file","accept",".xls, .xlsx",1,"hidden",3,"change"],["mat-flat-button","","color","accent",1,"flex","items-center","space-x-2",3,"click","disabled"],[3,"svgIcon",4,"ngIf"],["diameter","20",4,"ngIf"],[1,"example-table-container","bg-card","-mt-16","h-full","rounded-t-2xl","shadow","overflow-auto"],[1,"flex","flex-col","flex-auto","sm:mb-18","overflow-auto"],["mat-table","","matSort","",1,"w-full","table-fixed","border-separate","border-spacing-y-2","px-6",3,"dataSource"],["matColumnDef","id"],["mat-header-cell","","mat-sort-header","","class","px-4 py-3 text-left font-semibold",4,"matHeaderCellDef"],["mat-cell","","class","px-4 py-2",4,"matCellDef"],["matColumnDef","brandName"],["matColumnDef","description"],["matColumnDef","emblem"],["matColumnDef","action"],["mat-header-cell","","class","px-4 py-3 text-left font-semibold",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["showFirstLastButtons","","aria-label","Select page of periodic elements",1,"bottom-0","justify-self-end",3,"length","pageSize","pageSizeOptions"],[3,"svgIcon"],["diameter","20"],["mat-header-cell","","mat-sort-header","",1,"px-4","py-3","text-left","font-semibold"],["mat-cell","",1,"px-4","py-2"],["mat-header-cell","",1,"px-4","py-3","text-left","font-semibold"],["mat-flat-button","","color","primary",1,"fuse-mat-button-large","mr-2",3,"click"],["mat-flat-button","","color","warn",1,"fuse-mat-button-large",3,"click"],["mat-header-row",""],["mat-row",""]],template:function(n,t){if(n&1){let o=I();r(0,"div",2)(1,"div",3)(2,"div",4)(3,"div",5)(4,"h2",6),c(5," Brands "),s()()(),r(6,"div",7)(7,"mat-form-field",8),p(8,"mat-icon",9)(9,"input",10),s(),r(10,"button",11),S("click",function(){return g(o),_(t.openBrandCreateDialog())}),p(11,"mat-icon",12),r(12,"span",13),c(13,"Create New Brand"),s()(),r(14,"div",14)(15,"input",15,0),S("change",function(f){g(o);let a=E(16);return _(t.onFileUpload(f,a))}),s(),r(17,"button",16),S("click",function(){g(o);let f=E(16);return _(f.click())}),u(18,Fe,1,1,"mat-icon",17)(19,Ne,1,0,"mat-spinner",18),r(20,"span"),c(21),s()()()()(),r(22,"div",19)(23,"div",20)(24,"table",21),b(25,22),u(26,Ve,2,0,"th",23)(27,ze,2,1,"td",24),C(),b(28,25),u(29,He,2,0,"th",23)(30,je,2,1,"td",24),C(),b(31,26),u(32,Ae,2,0,"th",23)(33,Xe,2,1,"td",24),C(),b(34,27),u(35,$e,2,0,"th",23)(36,qe,2,1,"td",24),C(),b(37,28),u(38,Ue,1,0,"th",29)(39,Qe,5,0,"td",24),C(),u(40,Le,1,0,"tr",30)(41,Oe,1,0,"tr",31),s()()(),p(42,"mat-paginator",32,1),s()}n&2&&(l(7),d("subscriptSizing","dynamic"),l(),d("svgIcon","heroicons_solid:magnifying-glass"),l(),d("formControl",t.searchInputControl)("autocomplete","off")("placeholder","Search Brands"),l(),d("color","primary"),l(),d("svgIcon","heroicons_mini:plus"),l(6),d("disabled",t.isImporting),l(),d("ngIf",!t.isImporting),l(),d("ngIf",t.isImporting),l(2),X(t.isImporting?"Importing...":"Import Excel"),l(3),d("dataSource",t.dataSource),l(16),d("matHeaderRowDef",t.displayedColumns),l(),d("matRowDefColumns",t.displayedColumns),l(),d("length",t.totalItems)("pageSize",t.itemsPerPage)("pageSizeOptions",$(17,Re)))},dependencies:[U,q,Z,Y,K,J,fe,ce,pe,L,oe,te,ie,re,ae,ye,ue,ge,Se,_e,he,ve,be,Ce,xe,Be,G,W,O,se,le,De,we,M,Ee,Ie],encapsulation:2})}}return e})();var Tt=[{path:"",component:Pe}];export{Tt as default};
