import{a as q}from"./chunk-Z4PJH56D.js";import{a as V}from"./chunk-X77UPS6A.js";import{a as Y}from"./chunk-3FV7DAM6.js";import{a as L}from"./chunk-ALJ75YVM.js";import{a as O}from"./chunk-M5AHF4UO.js";import{a as j}from"./chunk-CI6T4FGN.js";import"./chunk-RHLCCWT6.js";import"./chunk-YEGTZ3HQ.js";import"./chunk-5RBAZJQA.js";import{b as F,c as C}from"./chunk-PNSBUHWU.js";import"./chunk-GXFYRQIF.js";import{b as B,d as k}from"./chunk-DJWEABC6.js";import{i as T,j as N,n as P,q as M,r as D}from"./chunk-MZLVPJ5Q.js";import{Bc as t,Cc as x,Db as A,Dc as d,Kb as y,Qc as v,Sc as u,Tb as h,ca as E,cc as e,dc as i,ea as _,ec as l,m as I,nb as a,oa as f,ob as p,oc as g,qc as w}from"./chunk-2GFQMTJ2.js";function U(m,b){if(m&1&&(e(0,"tr",23)(1,"td",28),t(2),i(),e(3,"td",28),t(4),i(),e(5,"td",34),t(6),v(7,"currency"),i()()),m&2){let r=b.$implicit,n=b.index;a(2),x(n+1),a(2),x(r.descriptions),a(2),d(" ",u(7,3,r.amount," ")," ")}}function z(m,b){if(m&1&&(e(0,"tr",27),l(1,"td",28),e(2,"td",29),t(3," DUE AMOUNT : "),i(),e(4,"td",30),t(5),v(6,"currency"),i()()),m&2){let r=w();a(5),d(" ",u(6,1,r.dueAmount," ")," ")}}var R=(()=>{class m{constructor(r,n,o,c,s,S){this._estimateService=r,this._invoicePaymentsService=n,this._estimateTreatmentService=o,this._vatService=c,this._invoiceService=s,this._invoiceItemService=S,this._unsubscribeAll=new I,this._route=f(B),this.vehicleEstimateTreatments=[],this.totalAmount=0,this.netTotalAmount=0,this.invoiceDate="",this.insurance="",this.invNo="",this.vehicleModel="",this.router=f(k),this.invoicePayments=[],this.totalPaidAmount=0,this.dueAmount=null}ngOnInit(){let r=this._route.snapshot.paramMap.get("id");r&&this._invoiceService.find(Number(r)).pipe(E(this._unsubscribeAll),_(n=>{n.body&&(this.getAllPayments(Number(r)),this.invoiceDetails=n.body,this.invNo=n.body.invoiceNumber,this.customerVATNumber=n.body.customerVATNumber,this.vehicleLicenseNumber=n.body.vehicleLicenseNumber,this.vehicleModel=n.body.vehicleModel,this.insurance=n.body.insuranceName,this.totalAmount=n.body.totalAmount,this.netTotalAmount=n.body.netTotalAmount,this.invoiceDate=n.body.invoiceDate.format("YYYY-MM-DD"),this._invoiceItemService.query({"invoiceId.equals":`${n.body.id}`}).subscribe(o=>{let c=o.body||[];this.vehicleEstimateTreatments=c.map(s=>({id:s.id,descriptions:s.descriptions,amount:s.amount,types:s.types})),console.log("\u{1F6E0}\uFE0F Job Item Time Estimations:",this.vehicleEstimateTreatments)}))})).subscribe()}getAllPayments(r){let n={size:1e3,"invoiceId.equals":r};this._invoicePaymentsService.query(n).subscribe(o=>{this.invoicePayments=o.body||[],this.totalPaidAmount=this.invoicePayments.reduce((c,s)=>c+(s.amount||0),0),this.dueAmount=Math.max(this.totalAmount-this.totalPaidAmount,0)})}print(){window.print()}goBack(){let r=this.invoiceDetails.id;this.router.navigate(["/invoices-view/",r])}static{this.\u0275fac=function(n){return new(n||m)(p(j),p(V),p(O),p(q),p(L),p(Y))}}static{this.\u0275cmp=A({type:m,selectors:[["app-final-bill"]],decls:81,vars:20,consts:[["cdkScrollable","",1,"absolute","inset-0","min-w-0","overflow-auto","text-center","print:overflow-visible"],[1,"flex","space-x-4","mb-3","print:hidden","justify-end","items-end","p-6"],[1,"px-4","py-2","bg-gradient-to-r","from-gray-500","to-gray-700","hover:from-gray-600","hover:to-gray-800","rounded-lg","shadow","text-white","flex","items-center","transition-all","duration-200",3,"click"],[1,"icon-size-4","text-white",3,"svgIcon"],[1,"ml-2"],[1,"px-4","py-2","bg-gradient-to-r","from-rose-500","to-red-500","hover:from-rose-600","hover:to-red-600","rounded-lg","shadow","text-white","flex","items-center","transition-all","duration-200",3,"click"],[1,"inline-block","p-6","text-left","sm:p-10","print:p-0"],[1,"bg-card","w-240","rounded-2xl","p-16","shadow","print:w-auto","print:rounded-none","print:bg-transparent","print:shadow-none"],[1,"text-right","text-4xl","font-bold","text-primary"],[1,"text-primaryt"],[1,"text-2xl","font-bold"],[1,"text-sm","font-bold"],[1,"col-span-10","my-8","border-b-4"],[1,"bill-container","justify-right"],[1,"bill-meta"],[1,"mb-2","flex","text-xl"],[1,"w-40","ml-3"],[1,"col-span-10","my-4"],[1,"text-secondary","text-center","text-2xl","font-bold","underline"],[1,"bill-title"],[1,"text-xl","font-medium"],[1,"mt-12","grid","gap-x-1"],[1,"w-full","table-auto","border-collapse","text-left","text-sm"],[1,"border-b"],[1,"px-12","py-2","font-medium"],[1,"px-12","py-2","text-right","font-medium"],["class","border-b",4,"ngFor","ngForOf"],[1,"text-base","font-semibold"],[1,"px-12","py-2"],[1,"px-12","py-2","text-right","whitespace-nowrap"],[1,"px-12","py-2","text-right",2,"text-decoration","underline double"],[1,"px-auto","py-2"],[1,"py-2","text-right","whitespace-nowrap"],["class","text-base font-semibold",4,"ngIf"],[1,"px-12","py-2","text-right"]],template:function(n,o){n&1&&(e(0,"div",0)(1,"div",1)(2,"button",2),g("click",function(){return o.goBack()}),l(3,"mat-icon",3),e(4,"span",4),t(5,"Back"),i()(),e(6,"button",5),g("click",function(){return o.print()}),l(7,"mat-icon",3),e(8,"span",4),t(9,"Print"),i()()(),e(10,"div",6)(11,"div",7)(12,"div",8)(13,"div",9),t(14,"Nimesh Motor Works (PVT) LTD"),i(),e(15,"div",10),t(16," Repairs to all Diesel & Petrol Motor Vehicles, Tinkering & Painting "),i(),e(17,"div",11),t(18," No: 27/1, Jubile Rd, Laxapathiya, Moratuwa "),i(),e(19,"div",11),t(20,"Tel: 11-2648438 / 0743888718"),i(),e(21,"div",11),t(22,"E-mail: nimeshmotorw@gmail.com"),i()(),l(23,"div",12),e(24,"div",13)(25,"section",14)(26,"div",15)(27,"strong"),t(28,"INV NO: "),i(),l(29,"br"),e(30,"span",16),t(31),i()(),e(32,"div")(33,"strong"),t(34,"Insurance:"),i(),t(35),l(36,"br"),e(37,"strong"),t(38,"Vehicle No:"),i(),t(39),i(),e(40,"div")(41,"strong"),t(42,"Date:"),i(),t(43),v(44,"date"),l(45,"br"),e(46,"strong"),t(47,"Model:"),i(),t(48),i()(),l(49,"div",17),e(50,"div",18)(51,"section",19)(52,"div",20),t(53,"FINAL BILL"),i()()(),e(54,"div",21)(55,"table",22)(56,"thead")(57,"tr",23)(58,"th",24),t(59,"No"),i(),e(60,"th",24),t(61,"Description"),i(),e(62,"th",25),t(63,"Amount"),i()()(),e(64,"tbody"),y(65,U,8,6,"tr",26),e(66,"tr",27),l(67,"td",28),e(68,"td",29),t(69,"TOTAL :"),i(),e(70,"td",30),t(71),v(72,"currency"),i()(),e(73,"tr",27),l(74,"td",31),e(75,"td",32),t(76,"TOTAL PAYED :"),i(),e(77,"td",30),t(78),v(79,"currency"),i()(),y(80,z,7,4,"tr",33),i()()()()()()()),n&2&&(a(3),h("svgIcon","mat_outline:arrow_back"),a(4),h("svgIcon","mat_outline:print"),a(24),x(o.invNo),a(4),d(" ",o.insurance,""),a(4),d(" ",o.vehicleLicenseNumber," "),a(4),d(" ",u(44,11,o.invoiceDate,"medium"),""),a(5),d(" ",o.vehicleModel," "),a(17),h("ngForOf",o.vehicleEstimateTreatments),a(6),d(" ",u(72,14,o.totalAmount," ")," "),a(7),d(" ",u(79,17,o.totalPaidAmount," ")," "),a(2),h("ngIf",o.dueAmount))},dependencies:[D,T,N,M,P,C,F],encapsulation:2})}}return m})();var me=[{path:"",component:R}];export{me as default};
