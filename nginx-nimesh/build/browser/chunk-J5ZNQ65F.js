import{a as me}from"./chunk-FKEP7USQ.js";import{d as ce}from"./chunk-MBFKKYVB.js";import{f as pe}from"./chunk-R44K775J.js";import{a as X,b as Y,c as Z,d as ee,e as te,f as ie,g as ne,h as re,i as oe,j as ae,k as le,l as R}from"./chunk-4HPTI4QK.js";import{a as D,b as se}from"./chunk-4IV6I57G.js";import{a as h,b as W,c as M}from"./chunk-YEGTZ3HQ.js";import{a as K}from"./chunk-5RBAZJQA.js";import{K as B}from"./chunk-MXRUEL7B.js";import{a as k,b as P,g as z}from"./chunk-TEYA6QDP.js";import{a as J,d as Q}from"./chunk-VPJKTFM7.js";import{d as H,i as L}from"./chunk-DJWEABC6.js";import{r as q,w as U,y as O}from"./chunk-MZLVPJ5Q.js";import{Bc as l,Cc as f,Db as V,Dc as b,Jc as j,K as G,Kb as p,Tb as g,a as y,b as x,cc as r,dc as a,ec as S,fc as d,gc as u,ia as F,nb as s,oa as v,ob as C,oc as w,p as T,r as E,uc as N,vc as A,wc as $,y as c}from"./chunk-2GFQMTJ2.js";var de=(()=>{class t{constructor(){this.http=v(O),this.applicationConfigService=v(K),this.resourceUrl=this.applicationConfigService.getEndpointFor("api/inventory-batches","inventorymicro"),this.resourceSearchUrl=this.applicationConfigService.getEndpointFor("api/inventory-batches/_search","inventorymicro")}create(e){let i=this.convertDateFromClient(e);return this.http.post(this.resourceUrl,i,{observe:"response"}).pipe(c(n=>this.convertResponseFromServer(n)))}update(e){let i=this.convertDateFromClient(e);return this.http.put(`${this.resourceUrl}/${this.getInventoryBatchesIdentifier(e)}`,i,{observe:"response"}).pipe(c(n=>this.convertResponseFromServer(n)))}partialUpdate(e){let i=this.convertDateFromClient(e);return this.http.patch(`${this.resourceUrl}/${this.getInventoryBatchesIdentifier(e)}`,i,{observe:"response"}).pipe(c(n=>this.convertResponseFromServer(n)))}find(e){return this.http.get(`${this.resourceUrl}/${e}`,{observe:"response"}).pipe(c(i=>this.convertResponseFromServer(i)))}query(e){let i=M(e);return this.http.get(this.resourceUrl,{params:i,observe:"response"}).pipe(c(n=>this.convertResponseArrayFromServer(n)))}delete(e){return this.http.delete(`${this.resourceUrl}/${e}`,{observe:"response"})}search(e){let i=M(e);return this.http.get(this.resourceSearchUrl,{params:i,observe:"response"}).pipe(c(n=>this.convertResponseArrayFromServer(n)),G(()=>E([new U],T)))}getInventoryBatchesIdentifier(e){return e.id}compareInventoryBatches(e,i){return e&&i?this.getInventoryBatchesIdentifier(e)===this.getInventoryBatchesIdentifier(i):e===i}addInventoryBatchesToCollectionIfMissing(e,...i){let n=i.filter(W);if(n.length>0){let m=e.map(_=>this.getInventoryBatchesIdentifier(_));return[...n.filter(_=>{let I=this.getInventoryBatchesIdentifier(_);return m.includes(I)?!1:(m.push(I),!0)}),...e]}return e}convertDateFromClient(e){return x(y({},e),{txDate:e.txDate?.toJSON()??null,lmd:e.lmd?.toJSON()??null,manufactureDate:e.manufactureDate?.toJSON()??null,expireDate:e.expireDate?.toJSON()??null,addedDate:e.addedDate?.toJSON()??null})}convertDateFromServer(e){return x(y({},e),{txDate:e.txDate?h(e.txDate):void 0,lmd:e.lmd?h(e.lmd):void 0,manufactureDate:e.manufactureDate?h(e.manufactureDate):void 0,expireDate:e.expireDate?h(e.expireDate):void 0,addedDate:e.addedDate?h(e.addedDate):void 0})}convertResponseFromServer(e){return e.clone({body:e.body?this.convertDateFromServer(e.body):null})}convertResponseArrayFromServer(e){return e.clone({body:e.body?e.body.map(i=>this.convertDateFromServer(i)):null})}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275prov=F({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();var fe=()=>[5,10,20];function he(t,o){t&1&&(r(0,"th",18),l(1,"Item Name"),a())}function ve(t,o){if(t&1&&(r(0,"td",19),l(1),a()),t&2){let e=o.$implicit;s(),f(e.itemName)}}function Ce(t,o){t&1&&(r(0,"th",18),l(1,"Item Code"),a())}function ge(t,o){if(t&1&&(r(0,"td",19),l(1),a()),t&2){let e=o.$implicit;s(),f(e.itemCode)}}function Se(t,o){t&1&&(r(0,"th",18),l(1,"Quantity"),a())}function De(t,o){if(t&1&&(r(0,"td",19),l(1),a()),t&2){let e=o.$implicit;s(),f(e.quantity)}}function _e(t,o){t&1&&(r(0,"th",18),l(1,"Unit Price"),a())}function ye(t,o){if(t&1&&(r(0,"td",19),l(1),a()),t&2){let e=o.$implicit;s(),f(e.price)}}function xe(t,o){t&1&&(r(0,"th",18),l(1,"Line Total"),a())}function we(t,o){if(t&1&&(r(0,"td",19),l(1),a()),t&2){let e=o.$implicit;s(),f(e.lineTotal)}}function be(t,o){t&1&&S(0,"tr",20)}function Me(t,o){t&1&&S(0,"tr",21)}var ot=(()=>{class t{constructor(e,i,n,m){this.dialogRef=e,this.data=i,this.grnliness=n,this.router=m,this.inventorybatch=v(de),this.matColumnDef=["itemName","itemCode","quantity","sellprice","lineTotal"],this.grnDisplayedColumns=["itemName","itemCode","quantity","sellprice","lineTotal"],this.dataSource=new R([]),this.grnlines=[]}onAddMore(){this.dialogRef.close(),this.router.navigate(["/grn-create"],{queryParams:{suid:this.data.id}})}ngOnInit(){let e=this.data.id;this.fetchgrlines(e),this.fetchnbatch(e)}onClose(){this.dialogRef.close()}fetchgrlines(e){this.grnliness.query({"grnId.equals":e,size:2e7}).subscribe({next:i=>{this.grnlines=i.body||[],console.log("GRN Lines:",this.grnlines),this.dataSource=new R(this.grnlines),this.dataSource.paginator=this.paginator},error:i=>{console.error("GRN Lines error:",i)}})}fetchnbatch(e){let i={"id.equals":e};this.inventorybatch.query(i).subscribe({next:n=>{this.grnlines1=n.body??[],console.log("\u{1F4E6} Fetched GRN Line Batches hereeeeeeeee:",this.grnlines1)},error:n=>{console.error("\u274C Error fetching GRN Line Batches:",n)}})}static{this.\u0275fac=function(i){return new(i||t)(C(k),C(P),C(me),C(H))}}static{this.\u0275cmp=V({type:t,selectors:[["app-grn-views"]],viewQuery:function(i,n){if(i&1&&N(D,5),i&2){let m;A(m=$())&&(n.paginator=m.first)}},decls:32,vars:8,consts:[[1,"grid","grid-cols-3","items-center","gap-4","mb-4"],[1,"truncate"],[1,"text-lg","font-semibold","whitespace-nowrap","overflow-hidden","text-ellipsis"],[1,"flex","justify-end"],["mat-button","","color","warn","aria-label","Close",3,"click"],["mat-table","",1,"w-full","table-fixed","border-separate","border-spacing-y-1","text-sm",3,"dataSource"],["matColumnDef","itemName"],["mat-header-cell","","class","px-2 py-2 text-left font-medium",4,"matHeaderCellDef"],["mat-cell","","class","px-2 py-1",4,"matCellDef"],["matColumnDef","itemCode"],["matColumnDef","quantity"],["matColumnDef","sellprice"],["matColumnDef","lineTotal"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],[1,"flex","items-center","justify-between","mt-4"],["showFirstLastButtons","",3,"pageSize","pageSizeOptions"],["mat-flat-button","","color","accent",3,"click"],["mat-header-cell","",1,"px-2","py-2","text-left","font-medium"],["mat-cell","",1,"px-2","py-1"],["mat-header-row",""],["mat-row",""]],template:function(i,n){i&1&&(r(0,"div",0)(1,"div",1)(2,"h2",2),l(3),a()(),r(4,"div",1)(5,"h2",2),l(6),a()(),r(7,"div",3)(8,"button",4),w("click",function(){return n.onClose()}),l(9," close "),a()()(),r(10,"table",5),d(11,6),p(12,he,2,0,"th",7)(13,ve,2,1,"td",8),u(),d(14,9),p(15,Ce,2,0,"th",7)(16,ge,2,1,"td",8),u(),d(17,10),p(18,Se,2,0,"th",7)(19,De,2,1,"td",8),u(),d(20,11),p(21,_e,2,0,"th",7)(22,ye,2,1,"td",8),u(),d(23,12),p(24,xe,2,0,"th",7)(25,we,2,1,"td",8),u(),p(26,be,1,0,"tr",13)(27,Me,1,0,"tr",14),a(),r(28,"div",15),S(29,"mat-paginator",16),r(30,"button",17),w("click",function(){return n.onAddMore()}),l(31," Add more items "),a()()),i&2&&(s(3),b(" GRN Code: ",n.data.code," "),s(3),b(" Name: ",n.data.name," "),s(4),g("dataSource",n.dataSource),s(16),g("matHeaderRowDef",n.grnDisplayedColumns),s(),g("matRowDefColumns",n.grnDisplayedColumns),s(2),g("pageSize",5)("pageSizeOptions",j(7,fe)))},dependencies:[q,z,ce,Q,J,pe,B,le,X,Z,ne,ee,Y,re,te,ie,oe,ae,se,D,L],encapsulation:2})}}return t})();export{ot as a};
