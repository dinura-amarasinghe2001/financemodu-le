import{a as me}from"./chunk-VQIWVYPK.js";import{a as pe}from"./chunk-7RWLPLTW.js";import{a as ce,b as ue}from"./chunk-7KFYK36W.js";import{b as se}from"./chunk-HN3GTZ22.js";import{b as de}from"./chunk-2V7PXVXU.js";import{a as oe,c as le,d as re}from"./chunk-4WAQRQWE.js";import{d as P}from"./chunk-KKTU7MAV.js";import{A as Y,B as Z,H as ee,J as te,K as ie,O as ne,P as ae,b as k,i as $,j as O,l as Q,q as H,r as J,u as V,x as K,z as X}from"./chunk-MXRUEL7B.js";import{c as U}from"./chunk-PNSBUHWU.js";import{a as T,b as W,e as z,f as E,g as j}from"./chunk-TEYA6QDP.js";import{a as q,d as G}from"./chunk-VPJKTFM7.js";import{fa as x,ia as R}from"./chunk-GXFYRQIF.js";import{i as F,m as L,r as D}from"./chunk-MZLVPJ5Q.js";import{Aa as f,Ac as _,Bc as m,Db as I,Dc as g,Kb as b,Qc as S,Rc as w,Tb as n,Yc as N,a as B,aa as y,cc as a,dc as r,ec as M,ic as A,nb as l,ob as p,oc as C,y as u,za as h}from"./chunk-2GFQMTJ2.js";function Ce(d,v){if(d&1&&(a(0,"mat-option",16),m(1),r()),d&2){let i=v.$implicit;n("value",i),l(),g(" ",i.brandName," ")}}function ge(d,v){if(d&1&&(a(0,"mat-option",16),m(1),r()),d&2){let i=v.$implicit;n("value",i),l(),g(" ",i.modelName," ")}}function ve(d,v){if(d&1&&(a(0,"mat-option",16),m(1),r()),d&2){let i=v.$implicit;n("value",i),l(),g(" ",i.name," ")}}var Ue=(()=>{class d{constructor(i,e,t,o,s,c,he,fe){this.dialogRef=i,this.data=e,this._fb=t,this._vehicleRegistryService=o,this._brandService=s,this._modelService=c,this._cd=he,this._clientService=fe,this.brandControl=new V,this.allBrands=[],this.modelControl=new V,this.allModels=[],this.clientControl=new V,this.allClients=[]}ngOnInit(){this.vehicleForm=this._fb.group({licenseNo:[""],yom:[""],brand:[""],brandID:[""],modelID:[""],model:[""],modelNumber:[""],opsUnitID:[""],createdBy:[""],createdDate:[null],lastModifiedBy:[""],lastModifiedDate:[null],clientRegistry:[{}]}),this.data?.vehicle&&(this.vehicleForm.patchValue(this.data.vehicle),console.log("Vehicle Data",this.data.vehicle),this._modelService.query({page:0,size:2e3}).subscribe(i=>{this.allModels=i.body||[];let e=this.data.vehicle.model;if(console.log("Vehicle Model",e),e&&this.allModels.length){let t=this.allModels.find(o=>o.modelName===e.toString());t&&this.modelControl.setValue(t)}})),this._brandService.query({page:0,size:2e3}).subscribe(i=>{if(this.allBrands=i.body||[],this.data?.vehicle?.brand){let e=this.data.vehicle.brand;if(e&&this.allBrands.length){let t=this.allBrands.find(o=>o.brandName===e.toString());t&&this.brandControl.setValue(t)}}this.filteredBrands$=this.brandControl.valueChanges.pipe(y(""),u(e=>{let t=typeof e=="string"?e.toLowerCase():e?.brandName?.toLowerCase()||"";return t?this.filterBrand(t):this.allBrands.slice(0,5)}))}),this._clientService.query().subscribe(i=>{if(this.allClients=i.body||[],this.data?.vehicle?.clientRegistry){let e=this.data.vehicle.clientRegistry?.id;if(e&&this.allClients.length){let t=this.allClients.find(o=>o.id===e);t&&this.clientControl.setValue(t)}}this.filterdClients$=this.clientControl.valueChanges.pipe(y(""),u(e=>{let t=typeof e=="string"?e.toLowerCase():e?.name?.toLowerCase()||"";return t?this.filterdClient(t):this.allClients.slice(0,5)}))}),this.filterdModels$=this.modelControl.valueChanges.pipe(y(""),u(i=>typeof i=="string"?i.toLowerCase():i?.modelName?.toLowerCase()||""),u(i=>this.filterModelName(i)))}submitVehicle(){let i=this.vehicleForm.value;if(this.data?.vehicle?.id){let e=B(B({},this.data.vehicle),i);this._vehicleRegistryService.update(e).subscribe(t=>{console.log("Vehicle Updated Successfully",t),this.dialogRef.close(!0)})}else this._vehicleRegistryService.create(i).subscribe(e=>{console.log("Vehicle Created Successfully",e),this.dialogRef.close(e)})}filterBrand(i){if(!i)return this.allBrands;let e=i.toLowerCase();return this.allBrands.filter(t=>t.brandName?.toLowerCase().includes(e)||t.description?.toLowerCase().includes(e)||t.emblem?.toLowerCase().includes(e)||t.id?.toString().toLowerCase().includes(e))}filterdClient(i){if(!i)return this.allClients;let e=i.toLowerCase();return this.allClients.filter(t=>t.name?.toLowerCase().includes(e)||t.address?.toLowerCase().includes(e)||t.city?.toLowerCase().includes(e)||t.contactNumber1?.toString().toLowerCase().includes(e)||t.contactNumber2?.toString().toLowerCase().includes(e)||t.id?.toString().toLowerCase().includes(e))}onSelectClient(i){let e=i.option.value;console.log("Selected Client:",e),e&&this.vehicleForm.patchValue({clientRegistry:{id:e.id}})}onSelectBrand(i){let e=i.option.value;if(this.selectedBrandId=e.id,e){this.vehicleForm.patchValue({brand:e.brandName,brandID:e.id,model:null}),this.modelControl.setValue("");let t={page:0,size:2e3,"brandId.equals":this.selectedBrandId};this._modelService.query(t).subscribe(o=>{this.allModels=o.body||[],this.filterdModels$=this.modelControl.valueChanges.pipe(y(""),u(s=>{let c=typeof s=="string"?s.toLowerCase():s?.modelName?.toLowerCase()||"";return c?this.filterModelName(c):this.allModels.slice(0,5)})),console.log("Filtered Models for brand",this.selectedBrandId,this.allModels)})}}filterModelName(i){if(!i)return this.allModels;let e=i.toLowerCase();return this.allModels.filter(t=>t.modelName?.toLowerCase().includes(e)||t.description?.toLowerCase().includes(e)||t.id?.toString().toLowerCase().includes(e))}onSelecModel(i){let e=i.option.value;console.log("Selected Brand:",e),e&&this.vehicleForm.patchValue({model:e.modelName,modelID:e.id})}displayBrand(i){return i?.brandName||""}displayModel(i){return i?.modelName||""}displayClient(i){return i?.name||""}cancel(){this.dialogRef.close()}static{this.\u0275fac=function(e){return new(e||d)(p(T),p(W),p(ee),p(ce),p(me),p(pe),p(N),p(ue))}}static{this.\u0275cmp=I({type:d,selectors:[["app-vehicle-add-wizard"]],decls:38,vars:21,consts:[["autoBrand","matAutocomplete"],["autoModel","matAutocomplete"],["autoClient","matAutocomplete"],[1,"flex","flex-col","items-center","p-3","text-center","text-xl","font-semibold","text-gray-800","dark:text-white"],[1,"grid","grid-cols-1","sm:grid-cols-2","gap-x-4","gap-y-6","p-4",3,"formGroup"],["appearance","outline",1,"w-full"],["matInput","","formControlName","licenseNo"],["type","text","matInput","","placeholder","Type to find Brand",3,"formControl","matAutocomplete"],[3,"optionSelected","displayWith"],[3,"value",4,"ngFor","ngForOf"],["type","text","matInput","","placeholder","Type to find Model",3,"formControl","matAutocomplete"],["type","text","matInput","","placeholder","Type to find Client",3,"formControl","matAutocomplete"],[1,"p-4"],[1,"flex","flex-col","sm:flex-row","justify-center","gap-3","w-full"],["mat-button","",1,"w-full","sm:w-auto","rounded-lg","bg-gray-200","px-4","py-2","text-xl","text-gray-600","hover:bg-gray-300","dark:bg-gray-700","dark:text-white","dark:hover:bg-gray-600",3,"click"],["mat-button","",1,"w-full","sm:w-auto","rounded-lg","bg-red-500","px-4","py-2","text-xl","text-white","shadow-lg","hover:bg-red-600","focus:outline-none","focus:ring","focus:ring-red-300",3,"click"],[3,"value"]],template:function(e,t){if(e&1){let o=A();a(0,"h2",3),m(1),r(),a(2,"mat-dialog-content")(3,"form",4)(4,"mat-form-field",5)(5,"mat-label"),m(6,"Vehicle Number"),r(),M(7,"input",6),r(),a(8,"mat-form-field",5)(9,"mat-label"),m(10,"Brand"),r(),M(11,"input",7),a(12,"mat-autocomplete",8,0),C("optionSelected",function(c){return h(o),f(t.onSelectBrand(c))}),b(14,Ce,2,2,"mat-option",9),S(15,"async"),r()(),a(16,"mat-form-field",5)(17,"mat-label"),m(18,"Model"),r(),M(19,"input",10),a(20,"mat-autocomplete",8,1),C("optionSelected",function(c){return h(o),f(t.onSelecModel(c))}),b(22,ge,2,2,"mat-option",9),S(23,"async"),r()(),a(24,"mat-form-field",5)(25,"mat-label"),m(26,"Client"),r(),M(27,"input",11),a(28,"mat-autocomplete",8,2),C("optionSelected",function(c){return h(o),f(t.onSelectClient(c))}),b(30,ve,2,2,"mat-option",9),S(31,"async"),r()()()(),a(32,"mat-dialog-actions",12)(33,"div",13)(34,"button",14),C("click",function(){return h(o),f(t.cancel())}),m(35," Cancel "),r(),a(36,"button",15),C("click",function(){return h(o),f(t.submitVehicle())}),m(37),r()()()}if(e&2){let o=_(13),s=_(21),c=_(29);l(),g(" ",!(t.data==null||t.data.vehicle==null)&&t.data.vehicle.id?"Update Vehicle":"Create Vehicle",`
`),l(2),n("formGroup",t.vehicleForm),l(8),n("formControl",t.brandControl)("matAutocomplete",o),l(),n("displayWith",t.displayBrand),l(2),n("ngForOf",w(15,15,t.filteredBrands$)),l(5),n("formControl",t.modelControl)("matAutocomplete",s),l(),n("displayWith",t.displayModel),l(2),n("ngForOf",w(23,17,t.filterdModels$)),l(5),n("formControl",t.clientControl)("matAutocomplete",c),l(),n("displayWith",t.displayClient),l(2),n("ngForOf",w(31,19,t.filterdClients$)),l(7),g(" ",!(t.data==null||t.data.vehicle==null)&&t.data.vehicle.id?"Update":"Create"," ")}},dependencies:[D,F,L,j,E,z,O,$,k,te,K,Q,H,J,ie,X,Y,Z,G,q,U,P,se,ae,ne,R,x,de,re,oe,le],encapsulation:2})}}return d})();export{Ue as a};
