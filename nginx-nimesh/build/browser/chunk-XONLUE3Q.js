import{a as Ee}from"./chunk-J5ZNQ65F.js";import{a as ve,b as De}from"./chunk-FKEP7USQ.js";import{d as Me}from"./chunk-MBFKKYVB.js";import{a as ke,b as Re}from"./chunk-JCUL3757.js";import"./chunk-R44K775J.js";import{a as Ie}from"./chunk-PH6QFVW6.js";import{a as re,b as ae,c as oe,d as le,e as se,f as me,g as pe,h as ce,i as de,j as ue,k as ge}from"./chunk-4HPTI4QK.js";import{a as fe,b as he}from"./chunk-4IV6I57G.js";import{b as _e}from"./chunk-T73PE35A.js";import{c as Ce,d as xe,e as we,f as be,g as Se,h as ye}from"./chunk-ZGGKBBB7.js";import{a as ie}from"./chunk-E4TC4E2W.js";import{a as T}from"./chunk-YEGTZ3HQ.js";import"./chunk-OT3AQSDR.js";import"./chunk-5RBAZJQA.js";import{J as ee,O as te,P as ne,d as q,e as j,i as A,j as Y,l as K,q as Q,w as Z}from"./chunk-MXRUEL7B.js";import{b as X,c as J}from"./chunk-PNSBUHWU.js";import{c as O}from"./chunk-TEYA6QDP.js";import"./chunk-JTAP5U5F.js";import{a as $,d as U}from"./chunk-VPJKTFM7.js";import{W as H}from"./chunk-GXFYRQIF.js";import"./chunk-T4I3R2GV.js";import{e as L,i as W}from"./chunk-DJWEABC6.js";import{j as N,n as z,r as F}from"./chunk-MZLVPJ5Q.js";import{Aa as u,Ac as y,Bc as c,Db as G,Dc as w,Fc as v,Gc as D,Hc as I,Jc as E,Kb as g,Kc as V,Qc as P,Sc as B,Tb as p,Tc as k,Vb as M,cc as r,dc as a,ec as C,fc as f,gc as h,ic as x,nb as l,oa as b,ob as R,oc as _,qc as m,za as d}from"./chunk-2GFQMTJ2.js";var Ve=()=>["/grn-create"],Pe=()=>[5,10,20],Be=n=>["/grn-print",n];function Ne(n,o){if(n&1){let e=x();f(0),C(1,"mat-icon",40),r(2,"input",41),_("ngModelChange",function(t){d(e);let s=m();return u(s.searchByCode?s.filter.code=t:s.filter.name=t)})("keydown.enter",function(){d(e);let t=m();return u(t.loadSuppliers())}),a(),h()}if(n&2){let e=m();l(),p("svgIcon",e.searchByCode?"mat_outline:qr_code_scanner":"heroicons_solid:magnifying-glass"),l(),p("placeholder",e.searchByCode?"Search by Code":"Search by Name")("ngModel",e.searchByCode?e.filter.code:e.filter.name)}}function ze(n,o){if(n&1){let e=x();r(0,"mat-date-range-input",42)(1,"input",43),I("ngModelChange",function(t){d(e);let s=m();return D(s.filter.dateRange.start,t)||(s.filter.dateRange.start=t),u(t)}),_("dateChange",function(){d(e);let t=m();return u(t.onDateChange())}),a(),r(2,"input",44),I("ngModelChange",function(t){d(e);let s=m();return D(s.filter.dateRange.end,t)||(s.filter.dateRange.end=t),u(t)}),_("dateChange",function(){d(e);let t=m();return u(t.onDateChange())}),a()(),C(3,"mat-datepicker-toggle",45)(4,"mat-date-range-picker",null,1)}if(n&2){let e=y(5),i=m();p("rangePicker",e),l(),v("ngModel",i.filter.dateRange.start),l(),v("ngModel",i.filter.dateRange.end),l(),p("for",e)}}function Fe(n,o){n&1&&(r(0,"th",46),c(1," ID "),a())}function Le(n,o){if(n&1&&(r(0,"td",47),c(1),a()),n&2){let e=o.$implicit;l(),w(" ",e.id," ")}}function We(n,o){n&1&&(r(0,"th",48),c(1," GRN No "),a())}function He(n,o){if(n&1&&(r(0,"td",47),c(1),a()),n&2){let e=o.$implicit;l(),w(" ",e.grnCode," ")}}function Oe(n,o){n&1&&(r(0,"th",46),c(1," Name "),a())}function qe(n,o){if(n&1&&(r(0,"td",47),c(1),a()),n&2){let e=o.$implicit;l(),w(" ",e.supplierName," ")}}function je(n,o){n&1&&(r(0,"th",46),c(1," Invoice Code "),a())}function Ae(n,o){if(n&1){let e=x();f(0),r(1,"input",49),I("ngModelChange",function(t){d(e);let s=m(2);return D(s.editInputCode,t)||(s.editInputCode=t),u(t)}),a(),h()}if(n&2){let e=m(2);l(),v("ngModel",e.editInputCode)}}function Ye(n,o){if(n&1&&c(0),n&2){let e=m().$implicit;w(" ",e.supplierInvoiceCode," ")}}function $e(n,o){if(n&1&&(r(0,"td",47),g(1,Ae,2,1,"ng-container",18)(2,Ye,1,1,"ng-template",null,2,k),a()),n&2){let e=o.$implicit,i=y(3),t=m();l(),p("ngIf",t.editRowId===e.id)("ngIfElse",i)}}function Ue(n,o){n&1&&(r(0,"th",46),c(1," Invoice date "),a())}function Xe(n,o){if(n&1){let e=x();f(0),r(1,"input",50),I("ngModelChange",function(t){d(e);let s=m(2);return D(s.editInputDateStr,t)||(s.editInputDateStr=t),u(t)}),a(),h()}if(n&2){let e=m(2);l(),v("ngModel",e.editInputDateStr)}}function Je(n,o){if(n&1&&(c(0),P(1,"date")),n&2){let e=m().$implicit;w(" ",B(1,1,e.supplierInvoiceDate,"yyyy-MM-dd")," ")}}function Ke(n,o){if(n&1&&(r(0,"td",47),g(1,Xe,2,1,"ng-container",18)(2,Je,2,4,"ng-template",null,3,k),a()),n&2){let e=o.$implicit,i=y(3),t=m();l(),p("ngIf",t.editRowId===e.id)("ngIfElse",i)}}function Qe(n,o){n&1&&(r(0,"th",46),c(1," GRN Value "),a())}function Ze(n,o){if(n&1&&(r(0,"td",47),c(1),a()),n&2){let e=o.$implicit;l(),w(" ",e.amountOwing," ")}}function et(n,o){n&1&&(r(0,"th",46),c(1," Paid Status "),a())}function tt(n,o){if(n&1&&(r(0,"td",47),c(1),a()),n&2){let e=o.$implicit;l(),w(" ",e.inspected?"Paid":"Not Paid"," ")}}function nt(n,o){n&1&&C(0,"th",48)}function it(n,o){if(n&1){let e=x();r(0,"button",55),_("click",function(){d(e);let t=m().$implicit,s=m();return u(s.enableEdit(t))}),c(1," Update "),a()}}function rt(n,o){if(n&1){let e=x();r(0,"button",56),_("click",function(){d(e);let t=m().$implicit,s=m();return u(s.saveEdit(t.id))}),c(1," Save "),a()}}function at(n,o){if(n&1&&(r(0,"td",47)(1,"div",51)(2,"button",52),c(3," Print "),a(),g(4,it,2,0,"button",53)(5,rt,2,0,"button",54),a()()),n&2){let e=o.$implicit,i=m();l(2),p("routerLink",V(3,Be,e.id)),l(2),p("ngIf",i.editRowId!==e.id),l(),p("ngIf",i.editRowId===e.id)}}function ot(n,o){n&1&&C(0,"tr",57)}function lt(n,o){if(n&1){let e=x();r(0,"tr",58),_("click",function(){let t=d(e).$implicit,s=m();return u(s.onRowClick(t))}),a()}}var Te=(()=>{class n{refreshFilters(){this.filter.code="",this.filter.name="",this.filter.dateRange={start:null,end:null},this.searchByCode=!0,this.showDateRange=!1,this.loadSuppliers()}onRowClick(e){console.log("Row clicked:",e),this.editRowId!==e.id&&this.viewopenSupplierViewDialog(e.id,e.supplierName,e.grnCode)}viewopenSupplierViewDialog(e,i,t){this._dialogService.open(Ee,{width:"900px",height:"auto",data:{id:e,name:i,code:t}})}expandAccording(e){if(this.expandedRow===e){this.expandedRow=null,this.grnLinesData=[];return}this.expandedRow=e,this.grnlines.query({"grnId.equals":e}).subscribe({next:i=>{this.grnLinesData=i.body||[],console.log("GRN Lines:",this.grnLinesData)},error:i=>{console.error("GRN Lines error:",i)}})}toggleDetails(e){this.supplierbankacc.find(e).subscribe({next:i=>{console.log("Bank Account:",i)},error:i=>console.error("Bank Account error:",i)}),this.supplierbank.find(e).subscribe({next:i=>{console.log("Bank:",i)},error:i=>console.error("Bank error:",i)}),this.supservice.find(e).subscribe({next:i=>{console.log("Supplier:",i)},error:i=>console.error("Supplier error:",i)})}onPaginateChange(e){this.pageSize=e.pageSize,this.currentPage=e.pageIndex+1,this.loadSuppliers()}onFilterChange(){this.currentPage=1,this.loadSuppliers()}enableEdit(e){this.editRowId=e.id,this.editInputCode=e.supplierInvoiceCode,this.editInputDateStr=T(e.supplierInvoiceDate).format("YYYY-MM-DD")}saveEdit(e){let i={id:e,supplierInvoiceCode:this.editInputCode,supplierInvoiceDate:T(this.editInputDateStr)};this.grnservice.partialUpdate(i).subscribe({next:t=>{console.log("Updated successfully:",t),this.editRowId=null},error:t=>{console.error("Error while updating:",t)}})}ngOnInit(){this.loadSuppliers()}get displayedColumns(){let e=["code","vehicleOwnerName","vehicleBrand","vehicleModel","amountowing","subtotal","action"];return this.showId&&e.unshift("id"),e}constructor(e,i){this._dialogService=e,this._snackBarService=i,this.supservice=b(Ie),this.grnservice=b(De),this.grnlines=b(ve),this.supplierbank=b(Re),this.supplierbankacc=b(ke),this.supplier=[],this.currentPage=1,this.pageSize=10,this.totalItems=0,this.totalPages=0,this.filter={name:"",code:"",dateRange:{start:null,end:null}},this.showDateRange=!1,this.expandedRow=null,this.grnLinesData=[],this.selectedSupplierId=3,this.editRowId=null,this.editInputCode="",this.editInputDateStr="",this.itemsPerPage=10,this.showId=!1,this.searchByCode=!1}openVehicleCreateDialog(){}onDateChange(){console.log(this.filter.dateRange.start),console.log(this.filter.dateRange.end),this.filter.dateRange.start&&this.filter.dateRange.end&&this.loadSuppliers()}loadSuppliers(){let e={page:this.currentPage-1,size:this.pageSize,sort:"id,desc"};this.filter.name.trim()&&(e["supplierName.contains"]=this.filter.name.trim()),this.filter.code.trim()&&(e["grnCode.contains"]=this.filter.code.trim()),this.filter.dateRange?.start&&(e["supplierInvoiceDate.greaterThanOrEqual"]=this.formatDate(this.filter.dateRange.start,"start")),this.filter.dateRange?.end&&(e["supplierInvoiceDate.lessThanOrEqual"]=this.formatDate(this.filter.dateRange.end,"end")),this.grnservice.query(e).subscribe({next:i=>{this.supplier=i.body||[];let t=i.headers.get("X-Total-Count");this.totalItems=t?+t:0,this.totalPages=Math.ceil(this.totalItems/this.pageSize),console.log(this.supplier)},error:i=>{console.error("Error fetching supplier data:",i)}})}goToPage(e){e>=1&&e<=this.totalPages&&(this.currentPage=e,this.loadSuppliers())}nextPage(){this.goToPage(this.currentPage+1)}previousPage(){this.goToPage(this.currentPage-1)}onSearch(){this.currentPage=1,this.loadSuppliers()}onRowCountChange(){this.currentPage=1,this.loadSuppliers()}formatDate(e,i){let t=new Date(e);return i==="start"?t.setHours(0,0,0,0):t.setHours(23,59,59,999),t.toISOString()}static{this.\u0275fac=function(i){return new(i||n)(R(O),R(ie))}}static{this.\u0275cmp=G({type:n,selectors:[["app-grn"]],decls:61,vars:30,consts:[["dateRangePicker",""],["rangePicker",""],["displayCode",""],["displayDate",""],[1,"absolute","inset-0","flex","min-w-0","flex-col","overflow-hidden"],[1,"bg-default","flex","flex-col","p-6","pb-6","dark:bg-transparent","sm:flex-row","sm:items-center","sm:justify-between","sm:px-10","sm:pb-6","sm:pt-12","gap-4"],[1,"min-w-0","flex-1"],[1,"truncate","text-3xl","font-extrabold","leading-7","tracking-tight","sm:leading-10","md:text-4xl"],[1,"mt-6","flex","shrink-0","items-center","sm:ml-4","sm:mt-0"],[1,"flex","gap-2","mr-4"],["aria-label","Search by Code",1,"px-2","py-2","text-white","rounded-xl","transition-all","hover:bg-amber-400",3,"click"],[1,"flex","h-10","w-10","items-center","justify-center","rounded-lg","bg-indigo-100","text-indigo-800","dark:bg-indigo-600","dark:text-indigo-50"],[1,"text-2xl",3,"svgIcon"],["aria-label","Search by Name",1,"px-2","py-2","text-white","rounded-xl","transition-all","hover:bg-amber-400",3,"click"],["aria-label","Toggle Date Filter",1,"px-2","py-2","text-white","rounded-xl","transition-all","hover:bg-amber-400",3,"click"],["aria-label","Refresh Filters","title","Clear filters and reload",1,"px-2","py-2","text-white","rounded-xl","transition-all","hover:bg-amber-400","bg-gray-300",3,"click"],["svgIcon","mat_outline:refresh",1,"text-2xl"],[1,"fuse-mat-dense","fuse-mat-rounded","min-w-64",3,"subscriptSizing"],[4,"ngIf","ngIfElse"],["mat-flat-button","","color","primary",1,"ml-3",3,"click"],[1,"icon-size-4",3,"svgIcon"],[1,"ml-2"],["mat-flat-button","","color","primary",1,"ml-3",3,"routerLink"],[1,"example-table-container","bg-card","mt-6","rounded-t-2xl","shadow","overflow-auto","flex-1",2,"min-height","0","max-height","6020px"],[1,"flex","flex-col","flex-auto","sm:mb-18"],["mat-table","","matSort","",1,"w-full","table-fixed","border-separate","border-spacing-y-2",3,"dataSource"],["matColumnDef","id"],["mat-header-cell","","mat-sort-header","","class","sticky top-0 z-10 bg-white dark:bg-gray-900 px-4 py-3 text-left font-semibold",4,"matHeaderCellDef"],["mat-cell","","class","px-4 py-2",4,"matCellDef"],["matColumnDef","code"],["mat-header-cell","","class","sticky top-0 z-10 bg-white dark:bg-gray-900 px-4 py-3 text-left font-semibold",4,"matHeaderCellDef"],["matColumnDef","vehicleOwnerName"],["matColumnDef","vehicleBrand"],["matColumnDef","vehicleModel"],["matColumnDef","amountowing"],["matColumnDef","subtotal"],["matColumnDef","action"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","","class","cursor-pointer hover:bg-slate-400","style","display: table-row;",3,"click",4,"matRowDef","matRowDefColumns"],[3,"page","length","pageSize","pageIndex","pageSizeOptions"],["matPrefix","",1,"icon-size-5",3,"svgIcon"],["matInput","","autocomplete","off",3,"ngModelChange","keydown.enter","placeholder","ngModel"],[3,"rangePicker"],["matStartDate","","placeholder","From date","name","startDate",3,"ngModelChange","dateChange","ngModel"],["matEndDate","","placeholder","To date","name","endDate",3,"ngModelChange","dateChange","ngModel"],["matSuffix","",3,"for"],["mat-header-cell","","mat-sort-header","",1,"sticky","top-0","z-10","bg-white","dark:bg-gray-900","px-4","py-3","text-left","font-semibold"],["mat-cell","",1,"px-4","py-2"],["mat-header-cell","",1,"sticky","top-0","z-10","bg-white","dark:bg-gray-900","px-4","py-3","text-left","font-semibold"],[1,"border","rounded","px-2","py-1","w-full",3,"ngModelChange","ngModel"],["type","date",1,"border","rounded","px-2","py-1","w-full",3,"ngModelChange","ngModel"],[1,"flex","flex-wrap","gap-2"],["mat-flat-button","","color","primary",1,"fuse-mat-button-large",3,"routerLink"],["mat-flat-button","","class","fuse-mat-button-large","color","accent",3,"click",4,"ngIf"],["mat-flat-button","","class","fuse-mat-button-large","color","warn",3,"click",4,"ngIf"],["mat-flat-button","","color","accent",1,"fuse-mat-button-large",3,"click"],["mat-flat-button","","color","warn",1,"fuse-mat-button-large",3,"click"],["mat-header-row",""],["mat-row","",1,"cursor-pointer","hover:bg-slate-400",2,"display","table-row",3,"click"]],template:function(i,t){if(i&1){let s=x();r(0,"div",4)(1,"div",5)(2,"div",6)(3,"h2",7),c(4," Good Received Note "),a()(),r(5,"div",8)(6,"div",9)(7,"button",10),_("click",function(){return d(s),t.searchByCode=!0,u(t.showDateRange=!1)}),r(8,"div",11),C(9,"mat-icon",12),a()(),r(10,"button",13),_("click",function(){return d(s),t.searchByCode=!1,u(t.showDateRange=!1)}),r(11,"div",11),C(12,"mat-icon",12),a()(),r(13,"button",14),_("click",function(){return d(s),u(t.showDateRange=!t.showDateRange)}),r(14,"div",11),C(15,"mat-icon",12),a()(),r(16,"button",15),_("click",function(){return d(s),u(t.refreshFilters())}),r(17,"div",11),C(18,"mat-icon",16),a()()(),r(19,"mat-form-field",17),g(20,Ne,3,3,"ng-container",18)(21,ze,6,4,"ng-template",null,0,k),a(),r(23,"button",19),_("click",function(){return d(s),u(t.onFilterChange())}),C(24,"mat-icon",20),r(25,"span",21),c(26,"Search"),a()(),r(27,"button",22),C(28,"mat-icon",20),r(29,"span",21),c(30,"Create"),a()()()(),r(31,"div",23)(32,"div",24)(33,"table",25),f(34,26),g(35,Fe,2,0,"th",27)(36,Le,2,1,"td",28),h(),f(37,29),g(38,We,2,0,"th",30)(39,He,2,1,"td",28),h(),f(40,31),g(41,Oe,2,0,"th",27)(42,qe,2,1,"td",28),h(),f(43,32),g(44,je,2,0,"th",27)(45,$e,4,2,"td",28),h(),f(46,33),g(47,Ue,2,0,"th",27)(48,Ke,4,2,"td",28),h(),f(49,34),g(50,Qe,2,0,"th",27)(51,Ze,2,1,"td",28),h(),f(52,35),g(53,et,2,0,"th",27)(54,tt,2,1,"td",28),h(),f(55,36),g(56,nt,1,0,"th",30)(57,at,6,5,"td",28),h(),g(58,ot,1,0,"tr",37)(59,lt,1,0,"tr",38),a()()(),r(60,"mat-paginator",39),_("page",function(Ge){return d(s),u(t.onPaginateChange(Ge))}),a()()}if(i&2){let s=y(22);l(7),M("bg-amber-400",t.searchByCode&&!t.showDateRange)("bg-gray-300",!t.searchByCode||t.showDateRange),l(2),p("svgIcon","mat_outline:qr_code_scanner"),l(),M("bg-amber-400",!t.searchByCode&&!t.showDateRange)("bg-gray-300",t.searchByCode||t.showDateRange),l(2),p("svgIcon","heroicons_outline:user-circle"),l(),M("bg-amber-400",t.showDateRange)("bg-gray-300",!t.showDateRange),l(2),p("svgIcon","mat_outline:calendar_today"),l(4),p("subscriptSizing","dynamic"),l(),p("ngIf",!t.showDateRange)("ngIfElse",s),l(4),p("svgIcon","heroicons_mini:magnifying-glass"),l(3),p("routerLink",E(28,Ve)),l(),p("svgIcon","heroicons_mini:plus"),l(5),p("dataSource",t.supplier),l(25),p("matHeaderRowDef",t.displayedColumns),l(),p("matRowDefColumns",t.displayedColumns),l(),p("length",t.totalItems)("pageSize",t.pageSize)("pageIndex",t.currentPage-1)("pageSizeOptions",E(29,Pe))}},dependencies:[F,N,z,ee,K,Q,Z,W,L,he,fe,ge,re,oe,pe,le,ae,ce,se,me,de,ue,Y,A,q,j,ne,te,_e,U,$,Me,J,X,ye,Ce,be,xe,we,Se,H],encapsulation:2})}}return n})();var $t=[{path:"",component:Te,children:[]}];export{$t as default};
