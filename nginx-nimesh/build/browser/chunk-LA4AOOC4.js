import{a as H}from"./chunk-6F6RN6HY.js";import{a as Ie}from"./chunk-NMZNR4LF.js";import{a as Ee}from"./chunk-GDZACH7M.js";import{a as Ve}from"./chunk-6WEKFNCT.js";import{a as Se}from"./chunk-VQIWVYPK.js";import{a as we}from"./chunk-7RWLPLTW.js";import{a as Me}from"./chunk-GTGBE7YF.js";import{a as Te}from"./chunk-ALJ75YVM.js";import{a as W,b as J}from"./chunk-7KFYK36W.js";import{a as Ne}from"./chunk-Y6RDMGCV.js";import{a as De}from"./chunk-CI6T4FGN.js";import{a as G}from"./chunk-E4TC4E2W.js";import"./chunk-YEGTZ3HQ.js";import{a as ye}from"./chunk-3N5N6CVQ.js";import{b as be}from"./chunk-HN3GTZ22.js";import{b as xe}from"./chunk-2V7PXVXU.js";import{a as he,c as ve,d as fe}from"./chunk-4WAQRQWE.js";import{d as ce}from"./chunk-KKTU7MAV.js";import"./chunk-5RBAZJQA.js";import{A as pe,B as ue,H as _e,J as O,K as P,O as Ce,P as ge,b as ne,i as le,j as oe,l as $,q,r as de,u as M,x as me,z}from"./chunk-MXRUEL7B.js";import{b as L,c as se}from"./chunk-PNSBUHWU.js";import{c as j,g as ie}from"./chunk-TEYA6QDP.js";import"./chunk-JTAP5U5F.js";import{a as re,d as ae}from"./chunk-VPJKTFM7.js";import{fa as ee,ia as te}from"./chunk-GXFYRQIF.js";import"./chunk-T4I3R2GV.js";import{d as Z}from"./chunk-DJWEABC6.js";import{i as A,j as F,m as Y,r as R}from"./chunk-MZLVPJ5Q.js";import{Aa as _,Ac as V,Bc as s,Db as B,Dc as f,Ja as K,Kb as C,Qc as T,Rc as k,Tb as c,Tc as D,Vb as Q,Yc as X,aa as E,cc as o,dc as n,ec as p,fc as S,gc as w,ic as b,nb as r,oa as U,ob as x,oc as h,qc as d,y as I,za as u}from"./chunk-2GFQMTJ2.js";function Oe(l,m){if(l&1&&(o(0,"mat-option",21),s(1),n()),l&2){let e=m.$implicit;c("value",e),r(),f(" ",e.brandName," ")}}function Pe(l,m){if(l&1&&(S(0),C(1,Oe,2,2,"mat-option",20),T(2,"async"),w()),l&2){let e=d();r(),c("ngForOf",k(2,1,e.filteredBrands$))}}function We(l,m){if(l&1){let e=b();o(0,"mat-option",22),s(1,"No results found."),n(),o(2,"mat-option",23),h("click",function(){u(e);let i=d();return _(i.openBrandCreateDialog())}),o(3,"mat-icon",24),s(4,"add"),n(),s(5),n()}if(l&2){let e=d();r(5),f(' Add "',e.brandControl.value,'" ')}}function Je(l,m){if(l&1&&(o(0,"mat-option",21),s(1),n()),l&2){let e=m.$implicit;c("value",e),r(),f(" ",e.modelName," ")}}function He(l,m){if(l&1&&(S(0),C(1,Je,2,2,"mat-option",20),w()),l&2){let e=d().ngIf;r(),c("ngForOf",e)}}function Ge(l,m){if(l&1&&(S(0),C(1,He,2,1,"ng-container",13),w()),l&2){let e=d(),t=V(28);r(),c("ngIf",e.allModels.length>0)("ngIfElse",t)}}function Qe(l,m){if(l&1){let e=b();o(0,"mat-option",22),s(1,"No models found for this brand"),n(),o(2,"mat-option",23),h("click",function(){u(e);let i=d();return _(i.openModelCreateDialog())}),o(3,"mat-icon",24),s(4,"add"),n(),s(5," Add new model "),n()}}function Ue(l,m){if(l&1&&(o(0,"mat-option",21),s(1),n()),l&2){let e=m.$implicit;c("value",e),r(),f(" ",e.name," ")}}function Ke(l,m){if(l&1&&(S(0),C(1,Ue,2,2,"mat-option",20),w()),l&2){let e=d().ngIf;r(),c("ngForOf",e)}}function Xe(l,m){if(l&1&&(S(0),C(1,Ke,2,1,"ng-container",13),w()),l&2){let e=m.ngIf;d();let t=V(38);r(),c("ngIf",e.length>0)("ngIfElse",t)}}function Ye(l,m){if(l&1){let e=b();o(0,"mat-option",22),s(1,"No results found."),n(),o(2,"mat-option",23),h("click",function(){u(e);let i=d();return _(i.openClientreateDialog())}),o(3,"mat-icon",24),s(4,"add"),n(),s(5),n()}if(l&2){let e=d();r(5),f(' Add "',e.clientControl.value,'" ')}}var ke=(()=>{class l{constructor(e,t,i,a,g,v,y,N){this._fb=e,this._vehicleRegistryService=t,this._snackBar=i,this._brandService=a,this._modelService=g,this._cd=v,this._clientService=y,this._dialogService=N,this.vehicleCreated=new K,this.brandControl=new M,this.allBrands=[],this.modelControl=new M,this.allModels=[],this.clientControl=new M,this.allClients=[]}ngOnInit(){this.vehicleForm=this._fb.group({licenseNo:[""],yom:[""],brand:[""],brandID:[""],modelID:[""],model:[""],modelNumber:[""],opsUnitID:[""],createdBy:[""],createdDate:[null],lastModifiedBy:[""],lastModifiedDate:[null],clientRegistry:[{}]});let e={page:0,size:2e3};this._modelService.query(e).subscribe(t=>{this.allModels=t.body||[]}),this._brandService.query(e).subscribe(t=>{this.allBrands=t.body||[],this.filteredBrands$=this.brandControl.valueChanges.pipe(E(""),I(i=>{let a=typeof i=="string"?i.toLowerCase():i?.brandName?.toLowerCase()||"";return a?this.filterBrand(a):this.allBrands.slice(0,5)}))}),this._clientService.query().subscribe(t=>{this.allClients=t.body||[],this.filterdClients$=this.clientControl.valueChanges.pipe(E(""),I(i=>{let a=typeof i=="string"?i.toLowerCase():i?.name?.toLowerCase()||"";return a?this.filterdClient(a):this.allClients.slice(0,5)}))}),this.filterdModels$=this.modelControl.valueChanges.pipe(E(""),I(t=>typeof t=="string"?t.toLowerCase():t?.modelName?.toLowerCase()||""),I(t=>this.filterModelName(t)))}submitVehicle(){let e=this.vehicleForm.value;this._vehicleRegistryService.create(e).subscribe(t=>{if(console.log("Vehicle Created Successfully",t),t.body){let i=t.body?.licenseNo;this.vehicleCreated.emit(i)}this._snackBar.open("Vehicle created successfully!","Close",{duration:3e3,panelClass:["bg-green-500","text-white"],verticalPosition:"bottom"})})}filterBrand(e){if(!e)return this.allBrands;let t=e.toLowerCase();return this.allBrands.filter(i=>i.brandName?.toLowerCase().includes(t)||i.description?.toLowerCase().includes(t)||i.emblem?.toLowerCase().includes(t)||i.id?.toString().toLowerCase().includes(t))}filterdClient(e){if(!e)return this.allClients;let t=e.toLowerCase();return this.allClients.filter(i=>i.name?.toLowerCase().includes(t)||i.address?.toLowerCase().includes(t)||i.city?.toLowerCase().includes(t)||i.contactNumber1?.toString().toLowerCase().includes(t)||i.contactNumber2?.toString().toLowerCase().includes(t)||i.id?.toString().toLowerCase().includes(t))}onSelectClient(e){let t=e.option.value;console.log("Selected Client:",t),t&&this.vehicleForm.patchValue({clientRegistry:{id:t.id}})}onSelectBrand(e){let t=e.option.value;if(this.selectedBrandId=t.id,t){this.vehicleForm.patchValue({brand:t.brandName,brandID:t.id,model:null}),this.modelControl.setValue("");let i={page:0,size:2e3,"brandId.equals":this.selectedBrandId};this._modelService.query(i).subscribe(a=>{this.allModels=a.body||[],this.filterdModels$=this.modelControl.valueChanges.pipe(E(""),I(g=>{let v=typeof g=="string"?g.toLowerCase():g?.modelName?.toLowerCase()||"";return v?this.filterModelName(v):this.allModels.slice(0,5)})),console.log("Filtered Models for brand",this.selectedBrandId,this.allModels)})}}filterModelName(e){if(!e)return this.allModels;let t=e.toLowerCase();return this.allModels.filter(i=>i.modelName?.toLowerCase().includes(t)||i.description?.toLowerCase().includes(t)||i.id?.toString().toLowerCase().includes(t))}onSelecModel(e){let t=e.option.value;console.log("Selected Brand:",t),t&&this.vehicleForm.patchValue({model:t.modelName,modelID:t.id})}displayBrand(e){return e?.brandName||""}displayModel(e){return e?.modelName||""}displayClient(e){return e?.name||""}openBrandCreateDialog(){this._dialogService.open(Ie,{width:"80vh",maxHeight:"90vh"}).afterClosed().subscribe(t=>{if(t){this.vehicleForm.patchValue({brand:t.body.brandName,brandID:t.body.id,model:null}),this.brandControl.setValue(t.body),this.selectedBrandId=t.body.id;let i={page:0,size:2e3,"brandId.equals":this.selectedBrandId};this._modelService.query(i).subscribe(a=>{this.allModels=a.body||[]}),this.getAllBrands()}})}getAllBrands(){this._brandService.query({size:1e3}).subscribe(e=>{this.allBrands=e.body||[],this.filteredBrands$=this.brandControl.valueChanges.pipe(E(""),I(t=>{let i=typeof t=="string"?t.toLowerCase():"";return this.allBrands.filter(a=>a.brandName.toLowerCase().includes(i))}))})}openModelCreateDialog(){this._dialogService.open(Ee,{width:"80vh",maxHeight:"90vh",data:{brands:this.allBrands,selectedBrandId:this.selectedBrandId}}).afterClosed().subscribe(t=>{if(t){this.modelControl.setValue(t.body),this.vehicleForm.patchValue({model:t.body.modelName,modelID:t.body.id});let i={page:0,size:2e3,"brandId.equals":this.selectedBrandId};this._modelService.query(i).subscribe(a=>{this.allModels=a.body||[]})}})}openClientreateDialog(){this._dialogService.open(H,{width:"80vh",maxHeight:"90vh"}).afterClosed().subscribe(t=>{t&&(this.clientControl.setValue(t.body),this.vehicleForm.patchValue({clientRegistry:{id:t.body.id}}))})}static{this.\u0275fac=function(t){return new(t||l)(x(_e),x(W),x(G),x(Se),x(we),x(X),x(J),x(j))}}static{this.\u0275cmp=B({type:l,selectors:[["app-vehicle-add-dashboard"]],outputs:{vehicleCreated:"vehicleCreated"},decls:43,vars:20,consts:[["autoBrand","matAutocomplete"],["noResults",""],["autoModel","matAutocomplete"],["showAddButton",""],["autoClient","matAutocomplete"],["noClientsFound",""],[1,"bg-card","w-full","h-full","mx-auto","rounded-lg","shadow-2xl","dark:bg-gray-800","px-4","sm:px-6","md:px-8","lg:px-10"],[1,"flex","flex-col","items-center","p-3","text-center","text-xl","font-semibold","text-gray-800","dark:text-white"],[1,"grid","grid-cols-1","xl:grid-cols-2","gap-x-4","gap-y-6","p-10","sm:p-6",3,"formGroup"],["appearance","outline",1,"w-full","min-w-0"],["matInput","","formControlName","licenseNo"],["type","text","matInput","","placeholder","Type to find Brand",3,"formControl","matAutocomplete"],[3,"optionSelected","displayWith"],[4,"ngIf","ngIfElse"],["type","text","matInput","","placeholder","Type to find Model",3,"formControl","matAutocomplete"],[4,"ngIf"],["type","text","matInput","","placeholder","Type to find Client",3,"formControl","matAutocomplete"],[1,"p-4"],[1,"flex","flex-col","sm:flex-row","justify-center","gap-3","w-full"],["mat-button","",1,"w-full","sm:w-auto","rounded-lg","bg-red-500","px-4","py-2","text-xl","text-white","shadow-lg","hover:bg-red-600","focus:outline-none","focus:ring","focus:ring-red-300",3,"click"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["disabled",""],[3,"click"],[1,"mr-2"]],template:function(t,i){if(t&1){let a=b();o(0,"div",6)(1,"h2",7),s(2," Create Vehicle "),n(),o(3,"div")(4,"form",8)(5,"mat-form-field",9)(6,"mat-label"),s(7,"License Number"),n(),p(8,"input",10),n(),o(9,"mat-form-field",9)(10,"mat-label"),s(11,"Brand"),n(),p(12,"input",11),o(13,"mat-autocomplete",12,0),h("optionSelected",function(v){return u(a),_(i.onSelectBrand(v))}),C(15,Pe,3,3,"ng-container",13),T(16,"async"),C(17,We,6,1,"ng-template",null,1,D),n()(),o(19,"mat-form-field",9)(20,"mat-label"),s(21,"Model"),n(),p(22,"input",14),o(23,"mat-autocomplete",12,2),h("optionSelected",function(v){return u(a),_(i.onSelecModel(v))}),C(25,Ge,2,2,"ng-container",15),T(26,"async"),C(27,Qe,6,0,"ng-template",null,3,D),n()(),o(29,"mat-form-field",9)(30,"mat-label"),s(31,"Client"),n(),p(32,"input",16),o(33,"mat-autocomplete",12,4),h("optionSelected",function(v){return u(a),_(i.onSelectClient(v))}),C(35,Xe,2,2,"ng-container",15),T(36,"async"),C(37,Ye,6,1,"ng-template",null,5,D),n()()()(),o(39,"div",17)(40,"div",18)(41,"button",19),h("click",function(){return u(a),_(i.submitVehicle())}),s(42," Create "),n()()()()}if(t&2){let a,g=V(14),v=V(18),y=V(24),N=V(34);r(4),c("formGroup",i.vehicleForm),r(8),c("formControl",i.brandControl)("matAutocomplete",g),r(),c("displayWith",i.displayBrand),r(2),c("ngIf",((a=k(16,14,i.filteredBrands$))==null?null:a.length)>0)("ngIfElse",v),r(7),c("formControl",i.modelControl)("matAutocomplete",y),r(),c("displayWith",i.displayModel),r(2),c("ngIf",k(26,16,i.filterdModels$)),r(7),c("formControl",i.clientControl)("matAutocomplete",N),r(),c("displayWith",i.displayClient),r(2),c("ngIf",k(36,18,i.filterdClients$))}},dependencies:[R,A,F,Y,ie,oe,le,ne,O,me,$,q,de,P,z,pe,ue,ae,re,se,L,ce,be,ge,Ce,te,ee,xe,fe,he,ve],encapsulation:2})}}return l})();function Ze(l,m){l&1&&(S(0),p(1,"mat-icon",9),w()),l&2&&(r(),c("svgIcon","mat_outline:directions_car_filled"))}function et(l,m){l&1&&p(0,"mat-icon",9),l&2&&c("svgIcon","heroicons_outline:user-circle")}function tt(l,m){if(l&1&&(o(0,"div",29),s(1),n()),l&2){let e=d(3);r(),f(" ",e.allClientDetails[0]==null?null:e.allClientDetails[0].name," ")}}function it(l,m){l&1&&(o(0,"div",40),s(1," No client assigned "),n())}function nt(l,m){if(l&1){let e=b();o(0,"div",41),h("click",function(){u(e);let i=d().$implicit,a=d(2);return _(a.openClientEditDialog(a.allClientDetails[0],i))}),p(1,"mat-icon",42),n()}}function lt(l,m){if(l&1){let e=b();o(0,"div",43)(1,"button",44),h("click",function(){u(e);let i=d(3);return i.openClientCreateDialog(),_(i.openClientEditDialog(i.selectedCard.client,i.selectedCard==null?null:i.selectedCard.vehicle))}),s(2," + Create "),n()()}}function ot(l,m){if(l&1){let e=b();o(0,"div",21),h("click",function(){let i=u(e).$implicit,a=d(2);return _(a.selectCard(i,a.allClientDetails[0]))}),o(1,"div",22)(2,"div",23)(3,"div",24)(4,"div",25),p(5,"mat-icon",26),n(),o(6,"div",27)(7,"div",28),s(8,"License No"),n(),o(9,"div",29),s(10),n()(),o(11,"div",30)(12,"div",31)(13,"span",32),s(14),n()(),o(15,"div",33)(16,"span",32),s(17),n()()()(),o(18,"div",34)(19,"div",35),p(20,"mat-icon",26),n(),o(21,"div",27)(22,"div",28),s(23,"Client Name"),n(),C(24,tt,2,1,"div",36)(25,it,2,0,"div",37),n(),C(26,nt,2,0,"div",38)(27,lt,3,0,"div",39),n()()()()}if(l&2){let e=m.$implicit,t=d(2);r(5),c("svgIcon","mat_outline:directions_car_filled"),r(5),f(" ",e.licenseNo," "),r(4),f(" ",e.brand," "),r(3),f(" ",e.model," "),r(3),c("svgIcon","heroicons_outline:user-circle"),r(4),c("ngIf",t.allClientDetails.length),r(),c("ngIf",!t.allClientDetails.length),r(),c("ngIf",t.allClientDetails.length),r(),c("ngIf",!t.allClientDetails.length)}}function rt(l,m){if(l&1){let e=b();S(0),o(1,"div",47)(2,"div",48)(3,"div",49),s(4,"Pre Estimates"),n(),o(5,"div",4)(6,"button",50),h("click",function(){let i=u(e).$implicit,a=d(3);return a.selectCard(i,a.allClientDetails[0]),_(a.goToPreEstimate())}),p(7,"mat-icon",51),n()()(),o(8,"div",52)(9,"div",53),s(10),n()()(),o(11,"div",54),p(12,"mat-icon",55),n(),o(13,"div",47)(14,"div",48)(15,"div",49),s(16,"Estimates"),n(),o(17,"div",4)(18,"button",50),h("click",function(){let i=u(e).$implicit,a=d(3);return a.selectCard(i,a.allClientDetails[0]),_(a.goToEstimate())}),p(19,"mat-icon",51),n()()(),o(20,"div",52)(21,"div",53),s(22),n()()(),o(23,"div",54),p(24,"mat-icon",55),n(),o(25,"div",47)(26,"div",48)(27,"div",49),s(28,"Job Cards"),n(),o(29,"div",4)(30,"button",50),h("click",function(){let i=u(e).$implicit,a=d(3);return a.selectCard(i,a.allClientDetails[0]),_(a.goToJobCard())}),p(31,"mat-icon",51),n()()(),o(32,"div",52)(33,"div",53),s(34),n()()(),o(35,"div",54),p(36,"mat-icon",55),n(),o(37,"div",47)(38,"div",48)(39,"div",49),s(40,"Invoices"),n(),o(41,"div",4)(42,"button",50),h("click",function(){let i=u(e).$implicit,a=d(3);return a.selectCard(i,a.allClientDetails[0]),_(a.goToInvoice())}),p(43,"mat-icon",51),n()()(),o(44,"div",52)(45,"div",53),s(46),n()()(),w()}if(l&2){let e=d(3);r(10),f(" ",e.preEstimateCount," "),r(12),f(" ",e.estimateCount," "),r(12),f(" ",e.jobCardCount," "),r(12),f(" ",e.invoiceCount," ")}}function at(l,m){if(l&1&&(o(0,"div",45),C(1,rt,47,4,"ng-container",46),n()),l&2){let e=d(2);r(),c("ngForOf",e.allVehicleDetails)}}function st(l,m){if(l&1&&(o(0,"div",18),C(1,ot,28,9,"div",19)(2,at,2,1,"div",20),n()),l&2){let e=d();r(),c("ngForOf",e.allVehicleDetails),r(),c("ngIf",e.allVehicleDetails.length==1)}}function ct(l,m){if(l&1&&(o(0,"div",29),s(1),n()),l&2){let e=d(2);r(),f(" ",e.selectedCard.client==null?null:e.selectedCard.client.name," ")}}function dt(l,m){l&1&&(o(0,"div",40),s(1," No client assigned "),n())}function mt(l,m){if(l&1){let e=b();o(0,"div",41),h("click",function(){u(e);let i=d(2);return _(i.openClientEditDialog(i.selectedCard.client,i.selectedCard==null?null:i.selectedCard.vehicle))}),p(1,"mat-icon",42),n()}}function pt(l,m){if(l&1){let e=b();o(0,"div",43)(1,"button",44),h("click",function(){u(e);let i=d(2);return _(i.openClientEditDialog(i.selectedCard.client))}),s(2," + Create "),n()()}}function ut(l,m){if(l&1){let e=b();o(0,"div",45)(1,"div",47)(2,"div",48)(3,"div",49),s(4,"Pre Estimates"),n(),o(5,"div",4)(6,"button",50),h("click",function(){u(e);let i=d(2);return _(i.goToPreEstimate())}),p(7,"mat-icon",51),n()()(),o(8,"div",52)(9,"div",53),s(10),n()()(),o(11,"div",54),p(12,"mat-icon",55),n(),o(13,"div",47)(14,"div",48)(15,"div",49),s(16,"Estimates"),n(),o(17,"div",4)(18,"button",50),h("click",function(){u(e);let i=d(2);return _(i.goToEstimate())}),p(19,"mat-icon",51),n()()(),o(20,"div",52)(21,"div",53),s(22),n()()(),o(23,"div",54),p(24,"mat-icon",55),n(),o(25,"div",47)(26,"div",48)(27,"div",49),s(28,"Job Cards"),n(),o(29,"div",4)(30,"button",50),h("click",function(){u(e);let i=d(2);return _(i.goToJobCard())}),p(31,"mat-icon",51),n()()(),o(32,"div",52)(33,"div",53),s(34),n()()(),o(35,"div",54),p(36,"mat-icon",55),n(),o(37,"div",47)(38,"div",48)(39,"div",49),s(40,"Invoices"),n(),o(41,"div",4)(42,"button",50),h("click",function(){u(e);let i=d(2);return _(i.goToInvoice())}),p(43,"mat-icon",51),n()()(),o(44,"div",52)(45,"div",53),s(46),n()()()()}if(l&2){let e=d(2);r(10),f(" ",e.preEstimateCount," "),r(12),f(" ",e.estimateCount," "),r(12),f(" ",e.jobCardCount," "),r(12),f(" ",e.invoiceCount," ")}}function _t(l,m){if(l&1&&(o(0,"div",56)(1,"div",57)(2,"div",22)(3,"div",23)(4,"div",24)(5,"div",25),p(6,"mat-icon",26),n(),o(7,"div",27)(8,"div",28),s(9,"License No"),n(),o(10,"div",29),s(11),n()(),o(12,"div",30)(13,"div",31)(14,"span",32),s(15),n()(),o(16,"div",33)(17,"span",32),s(18),n()()()(),o(19,"div",34)(20,"div",35),p(21,"mat-icon",26),n(),o(22,"div",27)(23,"div",28),s(24,"Client Name"),n(),C(25,ct,2,1,"div",36)(26,dt,2,0,"div",37),n(),C(27,mt,2,0,"div",38)(28,pt,3,0,"div",39),n()()()(),C(29,ut,47,4,"div",20),n()),l&2){let e=d();r(6),c("svgIcon","mat_outline:directions_car_filled"),r(5),f(" ",e.selectedCard.vehicle.licenseNo," "),r(4),f(" ",e.selectedCard.vehicle.brand," "),r(3),f(" ",e.selectedCard.vehicle.model," "),r(3),c("svgIcon","heroicons_outline:user-circle"),r(4),c("ngIf",e.selectedCard==null?null:e.selectedCard.client),r(),c("ngIf",!(e.selectedCard!=null&&e.selectedCard.client)),r(),c("ngIf",e.selectedCard==null?null:e.selectedCard.client),r(),c("ngIf",!(e.selectedCard!=null&&e.selectedCard.client)),r(),c("ngIf",e.isVehicleSelected)}}function ht(l,m){if(l&1){let e=b();o(0,"div",58)(1,"app-vehicle-add-dashboard",59),h("vehicleCreated",function(i){u(e);let a=d();return _(a.handleVehicleCreated(i))}),n()()}}var Be=(()=>{class l{constructor(e,t,i,a,g,v,y,N,Ae){this._estimateService=e,this._preEstimateService=t,this._vehicleRegistryService=i,this._clientRegistryService=a,this._selectedCardService=g,this._dialogService=v,this._snackBarService=y,this._jobCardService=N,this._invoiceService=Ae,this.searchInputControl=new M,this.allVehicleDetails=[],this.allClientDetails=[],this.searchByVehicleNo=!0,this.isVehicleSelected=!1,this.fromDashboard=!1,this.selectedCard=null,this.estimateCount=0,this.preEstimateCount=0,this.invoiceCount=0,this.jobCardCount=0,this.showCreateVehicleForm=!1,this._router=U(Z),this.searchInputControl.valueChanges.subscribe(vt=>{this.searchVehicle()})}ngOnInit(){this.fromDashboard=!0,this._selectedCardService.selectedCard$.subscribe(e=>{this.selectedCard=e,this.isVehicleSelected=!!e;let t=e.vehicle?.licenseNo;this.getDetails(t),e&&(this.isVehicleSelected=!0)})}searchVehicle(){let e=this.searchInputControl.value?.trim();if(!e){this.allVehicleDetails=[];return}if(this.searchByVehicleNo){let t={page:"0",size:"1","licenseNo.contains":e};this._vehicleRegistryService.query(t).subscribe({next:i=>{this.allVehicleDetails=i.body??[];let a={page:"0",size:"1","id.equals":this.allVehicleDetails[0]?.clientRegistry?.id},g=this.allVehicleDetails[0]?.licenseNo;this.getDetails(g),this.allVehicleDetails.length>0&&(this.allClientDetails=[],this._clientRegistryService.query(a).subscribe(v=>{this.allClientDetails=v.body??[],console.log("Client Details: ",this.allClientDetails)}))},error:()=>{this.allVehicleDetails=[]}})}else{let t={page:"0",size:"5","name.contains":e};this._clientRegistryService.query(t).subscribe({next:i=>{this.allClientDetails=i.body??[];let a=i.body??[];if(a.length>0){let v={page:"0",size:"5","clientRegistryId.equals":a[0].id};this._vehicleRegistryService.query(v).subscribe({next:y=>{this.allVehicleDetails=y.body},error:()=>{this.allVehicleDetails=[]}})}else this.allVehicleDetails=[]},error:()=>{this.allVehicleDetails=[]}})}}set accessVehicle(e){localStorage.setItem("accessVehicle",e)}set accessClient(e){localStorage.setItem("accessClient",e)}selectCard(e,t){this.searchInputControl.setValue(""),this.searchByVehicleNo=!0,this.allVehicleDetails=[],this._selectedCardService.setSelectedCard(e,t),this.isVehicleSelected=!0,this.selectedCard={vehicle:e,client:t},this._estimateService.query({size:1e3,"licenseNo.contains":`${this.selectedCard?.vehicle?.licenseNo}`,sort:"createdDate,desc"}).subscribe(i=>{this.estimateCount=i.body.length}),this._preEstimateService.query({size:1e3,"licenseNo.contains":`${this.selectedCard?.vehicle?.licenseNo}`,sort:"createdDate,desc"}).subscribe(i=>{this.preEstimateCount=i.body.length}),this._jobCardService.query({size:1e3,"vehicleLicenseNumber.contains":`${this.selectedCard?.vehicle?.licenseNo}`,sort:"createdDate,desc"}).subscribe(i=>{this.jobCardCount=i.body.length}),this._invoiceService.query({size:1e3,"vehicleLicenseNumber.contains":`${this.selectedCard?.vehicle?.licenseNo}`}).subscribe(i=>{this.invoiceCount=i.body.length}),this.accessVehicle=JSON.stringify(e),this.accessClient=JSON.stringify(t)}getDetails(e){this._estimateService.query({size:1e3,"licenseNo.contains":`${e}`,sort:"createdDate,desc"}).subscribe(t=>{this.estimateCount=t.body.length}),this._preEstimateService.query({size:1e3,"licenseNo.contains":`${e}`,sort:"createdDate,desc"}).subscribe(t=>{this.preEstimateCount=t.body.length}),this._jobCardService.query({size:1e3,"vehicleLicenseNumber.contains":`${e}`,sort:"createdDate,desc"}).subscribe(t=>{this.jobCardCount=t.body.length}),this._invoiceService.query({size:1e3,"vehicleLicenseNumber.contains":`${e}`}).subscribe(t=>{this.invoiceCount=t.body.length})}openClientEditDialog(e,t){console.log("Owner: ",e),console.log("Vehicle: ",t);let i=this.allClientDetails;console.log("Owners: ",i);let a=this.fromDashboard;this._dialogService.open(H,{width:"80vh",maxHeight:"90vh",data:{owner:e,vehicle:t,owners:i,isFromDashboard:a}}).afterClosed().subscribe(v=>{v&&(this._snackBarService.open("Client updated successfully!","Close",{duration:3e3}),v.body.clientRegistry.id&&this._clientRegistryService.find(v.body.clientRegistry.id).subscribe(y=>{this._selectedCardService.setSelectedCard(this.selectedCard.vehicle,y.body)}),console.log(v))})}openVehicleCreateDialog(){this._dialogService.open(Ve,{width:"80vh",maxHeight:"90vh"}).afterClosed().subscribe(t=>{t&&(console.log("Vehicle created successfully",t),this._selectedCardService.setSelectedCard(t.body,null),this.allVehicleDetails=[],this.allClientDetails=[],this.searchInputControl.setValue(""),this.searchByVehicleNo=!0,this.allVehicleDetails=t.body)})}goToEstimate(){this._router.navigate(["/create-estimates"])}goToPreEstimate(){this._router.navigate(["/pre-estimates-create"])}goToJobCard(){this._router.navigate(["/job-cards-create"])}goToInvoice(){this._router.navigate(["/invoices-create"])}handleVehicleCreated(e){this.searchInputControl.setValue(e),this.searchVehicle()}static{this.\u0275fac=function(t){return new(t||l)(x(De),x(Me),x(W),x(J),x(ye),x(j),x(G),x(Ne),x(Te))}}static{this.\u0275cmp=B({type:l,selectors:[["app-dashboard"]],decls:22,vars:17,consts:[["clientIcon",""],[1,"absolute","inset-0","flex","min-w-0","flex-col","overflow-hidden"],[1,"bg-default","flex","flex-0","flex-col","p-6","dark:bg-transparent","sm:flex-row","sm:items-center","sm:justify-between","sm:px-10","sm:pt-3"],[1,"min-w-0","flex-1"],[1,"mt-2"],[1,"flex","flex-col","md:flex-row","items-center","gap-4"],[1,"flex","items-center","gap-2"],[1,"px-1","py-1","text-white","rounded-xl","transition-all","hover:bg-amber-400",3,"click"],[1,"flex","h-10","w-10","items-center","justify-center","rounded-lg","bg-indigo-100","text-indigo-800","dark:bg-indigo-600","dark:text-indigo-50"],[1,"text-current","text-2xl",3,"svgIcon"],[1,"flex","w-full","md:w-auto","flex-1","items-center","gap-2"],[1,"relative","w-full"],[1,"w-full","p-3","pl-12","border","border-gray-300","rounded-lg","focus:ring-2","focus:ring-amber-400",3,"keydown.enter","formControl","placeholder"],[1,"absolute","inset-y-0","left-0","flex","items-center","pl-3","pointer-events-none","text-gray-400"],[4,"ngIf","ngIfElse"],["class","flex flex-row gap-4 px-6",4,"ngIf"],["class","flex flex-row gap-4 px-6 py-2",4,"ngIf"],["class","flex justify-center items-center w-full h-full",4,"ngIf"],[1,"flex","flex-row","gap-4","px-6"],["class","rounded-2xl w-full md:w-[48%] lg:w-[48%]",3,"click",4,"ngFor","ngForOf"],["class","flex w-full flex-row rounded-2xl dark:bg-gray-800 gap-3",4,"ngIf"],[1,"rounded-2xl","w-full","md:w-[48%]","lg:w-[48%]",3,"click"],[1,"bg-card","flex","flex-col","rounded-2xl","p-4","shadow","h-full"],[1,"space-y-2"],[1,"flex","items-center"],[1,"flex","h-14","w-14","items-center","justify-center","rounded-2xl","bg-indigo-100","text-indigo-800","dark:bg-indigo-600","dark:text-indigo-50"],[1,"text-current","text-xl",3,"svgIcon"],[1,"ml-4","flex-auto","leading-none"],[1,"text-secondary","text-sm","font-medium"],[1,"mt-2","text-2xl","font-medium"],[1,"ml-6","mt-auto","flex","min-w-18","items-end","justify-end","gap-2"],[1,"bg-gray-400","rounded-lg","px-2","py-1","text-white"],[1,"text-white","text-sm","font-medium"],[1,"bg-red-400","rounded-lg","px-2","py-1","text-white"],[1,"flex","items-center","w-full"],[1,"flex","h-14","w-14","items-center","justify-center","rounded-2xl","bg-teal-100","text-teal-800","dark:bg-teal-600","dark:text-teal-50"],["class","mt-2 text-2xl font-medium",4,"ngIf"],["class","mt-2 text-sm text-gray-500 italic",4,"ngIf"],["class","bg-amber-400 rounded-lg px-2 py-1 text-white ml-4",3,"click",4,"ngIf"],["class","ml-auto",4,"ngIf"],[1,"mt-2","text-sm","text-gray-500","italic"],[1,"bg-amber-400","rounded-lg","px-2","py-1","text-white","ml-4",3,"click"],["svgIcon","settings",1,"text-current","text-xl"],[1,"ml-auto"],[1,"bg-blue-500","hover:bg-blue-600","text-white","text-sm","px-4","py-2","rounded-lg",3,"click"],[1,"flex","w-full","flex-row","rounded-2xl","dark:bg-gray-800","gap-3"],[4,"ngFor","ngForOf"],[1,"flex","w-48","flex-col","rounded-2xl","bg-white","p-6","shadow","dark:bg-gray-800"],[1,"flex","items-center","justify-between"],[1,"truncate","text-lg","font-medium"],["mat-icon-button","",3,"click"],["svgIcon","heroicons_mini:plus",1,"icon-size-5"],[1,"mt-2","flex","flex-col","items-center"],[1,"text-7xl","font-bold","leading-none","text-amber-500"],[1,"flex","justify-center","items-center"],["svgIcon","heroicons_outline:arrow-right",1,"text-red-500","h-8","w-8"],[1,"flex","flex-row","gap-4","px-6","py-2"],[1,"rounded-2xl","w-full","md:w-[48%]","lg:w-[48%]"],[1,"flex","justify-center","items-center","w-full","h-full"],[3,"vehicleCreated"]],template:function(t,i){if(t&1){let a=b();o(0,"div",1)(1,"div",2)(2,"div",3)(3,"div",4)(4,"div",5)(5,"div",6)(6,"button",7),h("click",function(){return u(a),_(i.searchByVehicleNo=!0)}),o(7,"div",8),p(8,"mat-icon",9),n()(),o(9,"button",7),h("click",function(){return u(a),_(i.searchByVehicleNo=!1)}),o(10,"div",8),p(11,"mat-icon",9),n()()(),o(12,"div",10)(13,"div",11)(14,"input",12),h("keydown.enter",function(){return u(a),_(i.searchVehicle())}),n(),o(15,"div",13),C(16,Ze,2,1,"ng-container",14)(17,et,1,1,"ng-template",null,0,D),n()()()()()()(),C(19,st,3,2,"div",15)(20,_t,30,10,"div",16)(21,ht,2,0,"div",17),n()}if(t&2){let a=V(18);r(6),Q("bg-amber-400",i.searchByVehicleNo)("bg-gray-300",!i.searchByVehicleNo),r(2),c("svgIcon","mat_outline:directions_car_filled"),r(),Q("bg-amber-400",!i.searchByVehicleNo)("bg-gray-300",i.searchByVehicleNo),r(2),c("svgIcon","heroicons_outline:user-circle"),r(3),c("formControl",i.searchInputControl)("placeholder",i.searchByVehicleNo?"Search by Vehicle Number":"Search by Client Name"),r(2),c("ngIf",i.searchByVehicleNo)("ngIfElse",a),r(3),c("ngIf",i.allVehicleDetails==null?null:i.allVehicleDetails.length),r(),c("ngIf",i.isVehicleSelected),r(),c("ngIf",(i.allVehicleDetails==null?null:i.allVehicleDetails.length)===0&&(i.searchInputControl.value==null?null:i.searchInputControl.value.trim()))}},dependencies:[R,A,F,O,$,q,P,z,L,ke],encapsulation:2})}}return l})();var ai=[{path:"",component:Be}];export{ai as default};
