import{a as fe,b as I}from"./chunk-7KFYK36W.js";import{b as ue}from"./chunk-HN3GTZ22.js";import{b as pe}from"./chunk-2V7PXVXU.js";import{a as ae,c as me,d as ce}from"./chunk-4WAQRQWE.js";import{d as H}from"./chunk-KKTU7MAV.js";import{A as te,B as ie,G as ne,H as oe,J as re,K as le,O as se,P as de,b as G,i as q,j as B,l as J,n as x,q as K,r as Q,u as X,x as Z,z as ee}from"./chunk-MXRUEL7B.js";import{b as $,c as Y}from"./chunk-PNSBUHWU.js";import{a as L,b as A,g as j}from"./chunk-TEYA6QDP.js";import{a as U,d as P}from"./chunk-VPJKTFM7.js";import{fa as W,ia as R}from"./chunk-GXFYRQIF.js";import{i as N,j as k,m as T,r as z}from"./chunk-MZLVPJ5Q.js";import{Aa as p,Ac as F,Bc as l,Db as M,Dc as S,Kb as b,Qc as D,Rc as O,Tb as a,a as g,aa as V,b as y,cc as o,dc as i,ec as c,ic as h,nb as m,ob as C,oc as u,qc as s,y as E,za as d}from"./chunk-2GFQMTJ2.js";function _e(r,f){if(r&1){let t=h();o(0,"button",16),u("click",function(){d(t);let n=s(2);return p(n.toggleCLient())}),l(1," Change Client "),i()}}function Ce(r,f){if(r&1){let t=h();o(0,"form",3),u("ngSubmit",function(){d(t);let n=s();return p(n.submitClient())}),o(1,"div",4)(2,"mat-form-field",5)(3,"mat-label"),l(4,"Name"),i(),c(5,"input",6),i(),o(6,"mat-form-field",5)(7,"mat-label"),l(8,"Email"),i(),c(9,"input",7),i(),o(10,"mat-form-field",5)(11,"mat-label"),l(12,"Contact Number 1"),i(),c(13,"input",8),i(),o(14,"mat-form-field",5)(15,"mat-label"),l(16,"Contact Number 2"),i(),c(17,"input",9),i(),o(18,"mat-form-field",5)(19,"mat-label"),l(20,"Address"),i(),c(21,"input",10),i(),o(22,"mat-form-field",5)(23,"mat-label"),l(24,"City"),i(),c(25,"input",11),i()(),o(26,"div",12)(27,"button",13),u("click",function(){d(t);let n=s();return p(n.cancel())}),l(28," Cancel "),i(),o(29,"button",14),l(30," Save Client "),i(),b(31,_e,2,0,"button",15),i()()}if(r&2){let t=s();a("formGroup",t.clientForm),m(29),a("disabled",t.clientForm.invalid),m(2),a("ngIf",t.isFromDashboard)}}function be(r,f){if(r&1&&(o(0,"div",30)(1,"span",31),l(2),i()()),r&2){let t=f.$implicit;m(2),S("",t.name," ")}}function he(r,f){if(r&1&&(o(0,"mat-option",32),l(1),i()),r&2){let t=f.$implicit;a("value",t),m(),S(" ",t.name," ")}}function ge(r,f){if(r&1){let t=h();o(0,"button",33),u("click",function(){d(t);let n=s(2);return p(n.toggleForm())}),c(1,"mat-icon",34),o(2,"span",35),l(3,"New"),i()()}r&2&&(m(),a("svgIcon","heroicons_mini:plus"))}function ve(r,f){if(r&1){let t=h();o(0,"form",3),u("ngSubmit",function(){d(t);let n=s(2);return p(n.submitClient())}),o(1,"div",4)(2,"mat-form-field",5)(3,"mat-label"),l(4,"Name"),i(),c(5,"input",6),i(),o(6,"mat-form-field",5)(7,"mat-label"),l(8,"Email"),i(),c(9,"input",7),i(),o(10,"mat-form-field",5)(11,"mat-label"),l(12,"Contact Number 1"),i(),c(13,"input",8),i(),o(14,"mat-form-field",5)(15,"mat-label"),l(16,"Contact Number 2"),i(),c(17,"input",9),i(),o(18,"mat-form-field",5)(19,"mat-label"),l(20,"Address"),i(),c(21,"input",10),i(),o(22,"mat-form-field",5)(23,"mat-label"),l(24,"City"),i(),c(25,"input",11),i(),o(26,"mat-form-field",5)(27,"mat-label"),l(28,"Last Vehicle ID"),i(),c(29,"input",36),i(),o(30,"mat-form-field",5)(31,"mat-label"),l(32,"Last Receipt ID"),i(),c(33,"input",37),i()(),o(34,"div",12)(35,"button",13),u("click",function(){d(t);let n=s(2);return p(n.cancel())}),l(36," Cancel "),i(),o(37,"button",14),l(38," Save Client "),i()()()}if(r&2){let t=s(2);a("formGroup",t.clientForm),m(37),a("disabled",t.clientForm.invalid)}}function xe(r,f){if(r&1){let t=h();o(0,"div",12)(1,"button",13),u("click",function(){d(t);let n=s(2);return p(n.cancel())}),l(2," Cancel "),i(),o(3,"button",38),u("click",function(){d(t);let n=s(2);return p(n.changeOwner())}),l(4," Change Client "),i()()}if(r&2){let t=s(2);m(3),a("disabled",t.clientForm.invalid)}}function we(r,f){if(r&1){let t=h();o(0,"div",17)(1,"div",18)(2,"mat-icon",19),u("click",function(){d(t);let n=s();return p(n.toggleCLient())}),i(),o(3,"div",20)(4,"span",21),l(5,"Current Client"),i()(),b(6,be,3,1,"div",22),i(),o(7,"div",23)(8,"mat-form-field",24)(9,"mat-label"),l(10,"Client"),i(),c(11,"input",25),o(12,"mat-autocomplete",26,0),u("optionSelected",function(n){d(t);let _=s();return p(_.onSelectClient(n))}),b(14,he,2,2,"mat-option",27),D(15,"async"),i()(),o(16,"div",17),b(17,ge,4,1,"button",28),i()(),b(18,ve,39,2,"form",1)(19,xe,5,1,"div",29),i()}if(r&2){let t=F(13),e=s();m(2),a("svgIcon","heroicons_outline:arrow-left"),m(4),a("ngForOf",e.allClientDetails),m(5),a("formControl",e.clientControl)("matAutocomplete",t),m(),a("displayWith",e.displayClient),m(2),a("ngForOf",O(15,9,e.filterdClients$)),m(3),a("ngIf",e.isFromDashboard),m(),a("ngIf",e.newClient),m(),a("ngIf",!e.newClient)}}var He=(()=>{class r{constructor(t,e,n,_,w,v){this.dialogRef=t,this.data=e,this._fb=n,this._clientRegistryService=_,this._clientService=w,this._vehicleService=v,this.allClientDetails=[],this.isFromDashboard=!1,this.selectClient=!1,this.clientControl=new X,this.allClients=[],this.newClient=!1,this.newClientID=""}ngOnInit(){this.clientForm=this._fb.group({id:[null],name:["",x.required],lastVehicleID:[""],lastReceiptID:[""],address:[""],city:[""],contactNumber1:["",x.required],contactNumber2:[""],email:["",[x.email]],opsUnitID:[""],createdBy:[""],createdDate:[null],lastModifiedBy:[""],lastModifiedDate:[null]}),this.data?.owner&&(this.clientForm.patchValue(this.data.owner),this.allClientDetails=this.data.owners,console.log("Client details",this.data.owners),this.isFromDashboard=this.data.isFromDashboard),this._clientService.query().subscribe(t=>{this.allClients=t.body||[],this.filterdClients$=this.clientControl.valueChanges.pipe(V(""),E(e=>{let n=typeof e=="string"?e.toLowerCase():e?.name?.toLowerCase()||"";return n?this.filterdClient(n):this.allClients.slice(0,5)}))})}filterdClient(t){if(!t)return this.allClients;let e=t.toLowerCase();return this.allClients.filter(n=>n.name?.toLowerCase().includes(e)||n.address?.toLowerCase().includes(e)||n.city?.toLowerCase().includes(e)||n.contactNumber1?.toString().toLowerCase().includes(e)||n.contactNumber2?.toString().toLowerCase().includes(e)||n.id?.toString().toLowerCase().includes(e))}onSelectClient(t){let e=t.option.value;console.log("Selected Client:",e),e&&(this.newClientID=e.id.toString(),this.clientForm.patchValue({id:e.id,name:e.name,lastVehicleID:e.lastVehicleID,lastReceiptID:e.lastReceiptID,address:e.address,city:e.city,contactNumber1:e.contactNumber1,contactNumber2:e.contactNumber2,email:e.email,opsUnitID:e.opsUnitID})),console.log("Client Form Value:",this.clientForm.value)}displayClient(t){return t?.name||""}submitClient(){let t=this.clientForm.value;if(this.data?.owner?.id){let e=g(g({},this.data.owner),t);this._clientRegistryService.update(e).subscribe(n=>{console.log("Client Updated Successfully",n),this.dialogRef.close(n)})}else this._clientRegistryService.create(t).subscribe(e=>{console.log("Client Created Successfully",e),this._vehicleService.find(this.data?.vehicle.id).subscribe(n=>{if(n.body){let _=n.body,w=y(g({},_),{clientRegistry:{id:e.body.id}});this._vehicleService.update(w).subscribe(v=>{console.log("Vehicle Updated Successfully",v),this.dialogRef.close(v)})}}),this.dialogRef.close(e)})}cancel(){this.dialogRef.close()}toggleCLient(){this.selectClient=!this.selectClient}toggleForm(){this.newClient=!this.newClient,this.data?.owner&&(this.data.owner.id=null),this.clientForm.reset()}changeOwner(){this._vehicleService.find(this.data?.vehicle.id).subscribe(t=>{if(t.body){let e=t.body,n=y(g({},e),{clientRegistry:{id:this.clientForm.value.id}});this._vehicleService.update(n).subscribe(_=>{console.log("Vehicle Updated Successfully",_),this.dialogRef.close(_)})}})}static{this.\u0275fac=function(e){return new(e||r)(C(L),C(A),C(oe),C(I),C(I),C(fe))}}static{this.\u0275cmp=M({type:r,selectors:[["app-owner-create-wizard"]],decls:2,vars:2,consts:[["autoClient","matAutocomplete"],["class","p-4 md:p-6 space-y-4 animate-fade-in",3,"formGroup","ngSubmit",4,"ngIf"],["class","",4,"ngIf"],[1,"p-4","md:p-6","space-y-4","animate-fade-in",3,"ngSubmit","formGroup"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-4"],["appearance","outline",1,"w-full"],["matInput","","formControlName","name","required",""],["matInput","","formControlName","email","type","email"],["matInput","","formControlName","contactNumber1","required",""],["matInput","","formControlName","contactNumber2"],["matInput","","formControlName","address"],["matInput","","formControlName","city"],[1,"flex","justify-end","gap-2","mt-4"],["mat-raised-button","","color","warn","type","button",3,"click"],["mat-raised-button","","color","primary","type","submit",3,"disabled"],["mat-raised-button","","color","accent","type","button",3,"click",4,"ngIf"],["mat-raised-button","","color","accent","type","button",3,"click"],[1,""],[1,"flex","items-center"],[1,"icon-size-10","text-black","cursor-pointer",3,"click","svgIcon"],[1,"px-2","py-1","text-white","w-32"],[1,"text-black","text-lg","font-medium"],["class","bg-red-400 rounded-lg px-2 py-1 text-white w-30",4,"ngFor","ngForOf"],[1,"flex","gap-3","mt-2"],["appearance","outline",1,"flex-1"],["type","text","matInput","","placeholder","Type to find Client",3,"formControl","matAutocomplete"],[3,"optionSelected","displayWith"],[3,"value",4,"ngFor","ngForOf"],["class","px-4 py-4 bg-gradient-to-r from-yellow-500 to-amber-500 hover:from-yellow-600 hover:to-amber-600 rounded-lg shadow text-white flex items-center transition-all duration-200",3,"click",4,"ngIf"],["class","flex justify-end gap-2 mt-4",4,"ngIf"],[1,"bg-red-400","rounded-lg","px-2","py-1","text-white","w-30"],[1,"text-white","text-sm","font-medium"],[3,"value"],[1,"px-4","py-4","bg-gradient-to-r","from-yellow-500","to-amber-500","hover:from-yellow-600","hover:to-amber-600","rounded-lg","shadow","text-white","flex","items-center","transition-all","duration-200",3,"click"],[1,"icon-size-4","text-white",3,"svgIcon"],[1,"ml-2"],["matInput","","formControlName","lastVehicleID"],["matInput","","formControlName","lastReceiptID"],["mat-raised-button","","color","primary",3,"click","disabled"]],template:function(e,n){e&1&&b(0,Ce,32,3,"form",1)(1,we,20,11,"div",2),e&2&&(a("ngIf",!n.selectClient),m(),a("ngIf",n.selectClient))},dependencies:[z,N,k,T,j,B,q,G,re,Z,J,K,Q,ne,le,ee,te,ie,P,U,Y,$,H,ue,de,se,R,W,pe,ce,ae,me],styles:["@keyframes _ngcontent-%COMP%_fade-in{0%{opacity:0;transform:translateY(20px)}to{opacity:1;transform:none}}.animate-fade-in[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fade-in .5s ease-out both}"]})}}return r})();export{He as a};
