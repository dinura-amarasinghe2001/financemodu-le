import{a as U}from"./chunk-7T3DP6DK.js";import{d as Oe}from"./chunk-MBFKKYVB.js";import{a as W}from"./chunk-YWX6AJPB.js";import{a as $e}from"./chunk-2BGIWFS4.js";import{a as He,b as Le}from"./chunk-JCUL3757.js";import{f as We}from"./chunk-R44K775J.js";import{a as je}from"./chunk-PH6QFVW6.js";import{a as ze}from"./chunk-LFICRIBC.js";import{a as Ie,b as Pe,c as ke,d as Ee,e as Fe,f as Te,g as De,h as Be,i as Re,j as Ve,k as Ne}from"./chunk-4HPTI4QK.js";import{a as O,b as Ae}from"./chunk-4IV6I57G.js";import{b as j}from"./chunk-T73PE35A.js";import{a as z}from"./chunk-E4TC4E2W.js";import"./chunk-YEGTZ3HQ.js";import"./chunk-OT3AQSDR.js";import{a as ve,c as be,d as we}from"./chunk-4WAQRQWE.js";import{b as Me}from"./chunk-HLRQKUHW.js";import"./chunk-5RBAZJQA.js";import{A as Ce,B as ye,H as xe,J as V,K as Se,O as N,P as A,b as ce,d as de,i as P,j as k,l as B,q as R,r as ue,u as fe,w as ge,x as he,z as _e}from"./chunk-MXRUEL7B.js";import{b as T,c as D}from"./chunk-PNSBUHWU.js";import{a as se,b as me,c as pe}from"./chunk-TEYA6QDP.js";import"./chunk-JTAP5U5F.js";import{a as E,d as F}from"./chunk-VPJKTFM7.js";import{fa as ae,ia as le}from"./chunk-GXFYRQIF.js";import"./chunk-T4I3R2GV.js";import{i as re}from"./chunk-DJWEABC6.js";import{i as ie,j as oe,m as ne,r as I}from"./chunk-MZLVPJ5Q.js";import{Aa as _,Ac as w,Bc as m,Db as M,Dc as v,Fc as L,Gc as q,Hc as G,Jc as Z,Kb as f,Qc as ee,Rc as te,Tb as p,Tc as Q,Vb as H,aa as X,cc as n,dc as r,ec as d,fc as y,gc as x,ic as S,nb as l,oa as g,ob as C,oc as u,qc as c,uc as J,vc as K,wc as Y,y as $,za as h}from"./chunk-2GFQMTJ2.js";function it(o,s){if(o&1&&(n(0,"mat-option",10),m(1),r()),o&2){let e=s.$implicit;p("value",e),l(),v(" ",e.fullPath," ")}}var qe=(()=>{class o{constructor(e,t,i,a){this.fb=e,this.dialogRef=t,this._snackBarService=i,this.data=a,this.inventoryservice=g(ze),this.categoryService=g(W),this.categories=[],this.parentCategoryControl=new fe(null),this.fullPathPreview="",this.categoryForm=this.fb.group({name:[""],parentCategory:[null]})}ngOnInit(){this.fetchCategories(),this.filteredCategories=this.categoryForm.controls.parentCategory.valueChanges.pipe(X(""),$(e=>typeof e=="string"?e:e?.fullPath),$(e=>e?this.categories.filter(t=>t.fullPath.toLowerCase().includes(e.toLowerCase())):this.categories.slice())),this.data?.supplier&&(this.categoryForm.patchValue(this.data.supplier),this.fullPathPreview=this.computeFullPath()),this.categoryForm.valueChanges.subscribe(()=>{this.fullPathPreview=this.computeFullPath()})}displayCategory(e){return e&&e.fullPath?e.fullPath:""}onCategorySelected(e,t){e.isUserInput&&this.parentCategoryControl.setValue(t)}fetchCategories(){this.categoryService.query().subscribe({next:e=>{this.categories=e.body||[]},error:e=>{console.error("Failed to fetch categories:",e)}})}computeFullPath(){let e=this.categoryForm.controls.parentCategory.value,t=this.categoryForm.controls.name.value||"";if(e){if(typeof e=="object"&&e.fullPath)return`${e.fullPath}/${t}`;if(typeof e=="string"&&e.trim()!=="")return console.log("tis works"),`${e.trim()}/${t}`}return t||""}itemsave(){let e=this.computeFullPath(),t={id:null,name:this.categoryForm.value.name,fullPath:e};e.endsWith("/")&&(e=e.slice(0,-1)),console.log(e),this.categoryService.create(t).subscribe({next:i=>{this._snackBarService.open("Category created successfully!","Close",{duration:3e3}),this.dialogRef.close(!0),window.location.reload()},error:i=>{console.error("Error creating category:",i)}})}onSave(){this.categoryForm.valid?this.itemsave():console.warn("Form is invalid")}static{this.\u0275fac=function(t){return new(t||o)(C(xe),C(se),C(z),C(me))}}static{this.\u0275cmp=M({type:o,selectors:[["app-category-create"]],decls:23,vars:8,consts:[["auto","matAutocomplete"],[3,"formGroup"],[1,"text-lg","text-gray-600","mt-2"],["appearance","outline",1,"w-full"],["type","text","matInput","","placeholder","Category",3,"formControl","matAutocomplete"],[3,"displayWith"],[3,"value",4,"ngFor","ngForOf"],["matInput","","formControlName","name","placeholder","Enter name"],[1,"flex","justify-end","mt-4"],["mat-raised-button","","color","primary",3,"click"],[3,"value"]],template:function(t,i){if(t&1){let a=S();n(0,"form",1)(1,"div",2)(2,"strong"),m(3,"Full Path:"),r(),m(4),r(),d(5,"br"),n(6,"mat-form-field",3)(7,"mat-label"),m(8,"Parent Category (optional)"),r(),d(9,"input",4),n(10,"mat-autocomplete",5,0),f(12,it,2,2,"mat-option",6),ee(13,"async"),r()(),n(14,"mat-form-field",3)(15,"mat-label"),m(16,"Category Name"),r(),d(17,"input",7),r(),n(18,"div",8)(19,"button",9),u("click",function(){return h(a),_(i.onSave())}),n(20,"mat-icon"),m(21,"save"),r(),m(22," Save Category "),r()()()}if(t&2){let a=w(11);p("formGroup",i.categoryForm),l(4),v(" ",i.fullPathPreview||"N/A",`
`),l(5),p("formControl",i.categoryForm.controls.parentCategory)("matAutocomplete",a),l(),p("displayWith",i.displayCategory),l(2),p("ngForOf",te(13,6,i.filteredCategories))}},dependencies:[I,ie,ne,D,T,V,he,B,R,ue,Se,_e,Ce,ye,We,k,P,ce,A,N,j,ae,le,F,E,Me,$e,we,ve,be],encapsulation:2})}}return o})();var ot=()=>[5,10,20];function nt(o,s){o&1&&(n(0,"th",34),m(1," FullPath "),r())}function rt(o,s){if(o&1){let e=S();y(0),n(1,"input",37),G("ngModelChange",function(i){h(e);let a=c(2);return q(a.editfullPath,i)||(a.editfullPath=i),_(i)}),r(),x()}if(o&2){let e=c(2);l(),L("ngModel",e.editfullPath)}}function at(o,s){if(o&1&&m(0),o&2){let e=c().$implicit;v(" ",e.fullPath," ")}}function lt(o,s){if(o&1&&(n(0,"td",35),f(1,rt,2,1,"ng-container",36)(2,at,1,1,"ng-template",null,0,Q),r()),o&2){let e=s.$implicit,t=w(3),i=c();l(),p("ngIf",i.editRowId===e.id)("ngIfElse",t)}}function st(o,s){o&1&&(n(0,"th",34),m(1," Parent Name "),r())}function mt(o,s){if(o&1&&(n(0,"td",35),m(1),r()),o&2){let e=s.$implicit,t=c();l(),v(" ",t.getParentName(e.fullPath)," ")}}function pt(o,s){o&1&&(n(0,"th",34),m(1," ID "),r())}function ct(o,s){if(o&1&&(n(0,"td",35),m(1),r()),o&2){let e=s.$implicit;l(),v(" ",e.id," ")}}function dt(o,s){o&1&&(n(0,"th",34),m(1," Name "),r())}function ut(o,s){if(o&1){let e=S();y(0),n(1,"input",37),G("ngModelChange",function(i){h(e);let a=c(2);return q(a.editInputname,i)||(a.editInputname=i),_(i)}),r(),x()}if(o&2){let e=c(2);l(),L("ngModel",e.editInputname)}}function ft(o,s){if(o&1&&m(0),o&2){let e=c().$implicit;v(" ",e.name," ")}}function gt(o,s){if(o&1&&(n(0,"td",35),f(1,ut,2,1,"ng-container",36)(2,ft,1,1,"ng-template",null,1,Q),r()),o&2){let e=s.$implicit,t=w(3),i=c();l(),p("ngIf",i.editRowId===e.id)("ngIfElse",t)}}function ht(o,s){o&1&&d(0,"th",38)}function _t(o,s){if(o&1){let e=S();n(0,"button",43),u("click",function(){h(e);let i=c().$implicit,a=c();return _(a.enableEdit(i))}),m(1," Update "),r()}}function Ct(o,s){if(o&1){let e=S();n(0,"button",42),u("click",function(){h(e);let i=c().$implicit,a=c();return _(a.saveEdit(i.id))}),m(1," Save "),r()}}function yt(o,s){if(o&1){let e=S();n(0,"td",35)(1,"div",39),f(2,_t,2,0,"button",40)(3,Ct,2,0,"button",41),n(4,"button",42),u("click",function(){let i=h(e).$implicit,a=c();return _(a.deleteSupplier(i.id))}),m(5," Delete "),r()()()}if(o&2){let e=s.$implicit,t=c();l(2),p("ngIf",t.editRowId!==e.id),l(),p("ngIf",t.editRowId===e.id)}}function xt(o,s){o&1&&d(0,"tr",44)}function St(o,s){o&1&&d(0,"tr",45)}var Ge=(()=>{class o{enableEdit(e){this.editRowId=e.id,this.editInputname=e.name,this.editfullPath=e.fullPath}getParentName(e){if(!e)return"";let t=e.split("/").filter(i=>i.trim()!=="");return t.length>=2?t[t.length-2]:t.length===1?t[0]:""}saveEdit(e){let t={id:e,name:this.editInputname,fullPath:this.editfullPath};this.category.partialUpdate(t).subscribe({next:i=>{console.log("Updated successfully:",i),this.editRowId=null,this.paginator&&this.paginator.firstPage(),this.currentPage=1,this.loadSuppliers()},error:i=>{console.error("Error while updating:",i)}})}openSupplierViewDialog(e){this._dialogService.open(U,{data:{id:e}})}toggleDetails(e){this.supplierbankacc.find(e).subscribe({next:t=>{console.log("Bank Account:",t)},error:t=>console.error("Bank Account error:",t)}),this.supplierbank.find(e).subscribe({next:t=>{console.log("Bank:",t)},error:t=>console.error("Bank error:",t)}),this.supservice.find(e).subscribe({next:t=>{console.log("Supplier:",t)},error:t=>console.error("Supplier error:",t)})}onPaginateChange(e){this.pageSize=e.pageSize,this.currentPage=e.pageIndex+1,this.loadSuppliers()}deleteSupplier(e){this.category.delete(e).subscribe({next:()=>{this._snackBarService.open("  deleted successfully!","Close",{duration:3e3}),this.loadSuppliers()},error:t=>{console.error("Supplier delete failed",t),this._snackBarService.open("Supplier delete failed","Close",{duration:3e3})}})}refreshFilters(){this.filter.code="",this.filter.name="",this.searchByCode=!0,this.loadSuppliers()}ngOnInit(){this.loadSuppliers()}get displayedColumns(){let e=["code","vehicleOwnerName","parentName","action"];return this.showId&&e.unshift("id"),e}constructor(e,t){this._dialogService=e,this._snackBarService=t,this.category=g(W),this.supservice=g(je),this.supplierbank=g(Le),this.supplierbankacc=g(He),this.supplier=[],this.currentPage=1,this.pageSize=10,this.totalItems=0,this.totalPages=0,this.searchByCode=!1,this.filter={name:"",code:""},this.editRowId=null,this.editInputname="",this.editfullPath="",this.selectedSupplierId=3,this.itemsPerPage=10,this.showId=!1}openVehicleCreateDialog(){this._dialogService.open(qe,{width:"80vh",maxHeight:"95vh"}).afterClosed().subscribe(t=>{t&&this._snackBarService.open("Supplier Created Successfully!","Close",{duration:3e3})})}viewopenSupplierViewDialog(e){this._dialogService.open(U,{data:{id:e}})}onFilterChange(){this.currentPage=1,this.loadSuppliers()}loadSuppliers(){let e={page:this.currentPage-1,size:this.pageSize};this.filter.name.trim()&&(e["name.contains"]=this.filter.name.trim()),this.filter.code.trim()&&(e["fullPath.contains"]=this.filter.code.trim()),this.category.query(e).subscribe({next:t=>{this.supplier=t.body||[];let i=t.headers.get("X-Total-Count");this.totalItems=i?+i:0,this.totalPages=Math.ceil(this.totalItems/this.pageSize)},error:t=>{console.error("Error fetching supplier data:",t)}})}goToPage(e){e>=1&&e<=this.totalPages&&(this.currentPage=e,this.loadSuppliers())}nextPage(){this.goToPage(this.currentPage+1)}previousPage(){this.goToPage(this.currentPage-1)}onSearch(){this.currentPage=1,this.loadSuppliers()}onRowCountChange(){this.currentPage=1,this.loadSuppliers()}viewSupplier(e){console.log("Viewing supplier:",e)}static{this.\u0275fac=function(t){return new(t||o)(C(pe),C(z))}}static{this.\u0275cmp=M({type:o,selectors:[["app-category"]],viewQuery:function(t,i){if(t&1&&J(O,5),t&2){let a;K(a=Y())&&(i.paginator=a.first)}},decls:48,vars:24,consts:[["displayFullPath",""],["displayName",""],[1,"absolute","inset-0","flex","min-w-0","flex-col","overflow-hidden"],[1,"bg-default","flex","flex-0","flex-col","p-6","pb-22","dark:bg-transparent","sm:flex-row","sm:items-center","sm:justify-between","sm:px-10","sm:pb-28","sm:pt-12"],[1,"min-w-0","flex-1"],[1,"truncate","text-3xl","font-extrabold","leading-7","tracking-tight","sm:leading-10","md:text-4xl"],[1,"mt-6","flex","shrink-0","items-center","sm:ml-4","sm:mt-0"],[1,"flex","gap-2","mr-4"],["aria-label","Search by Code",1,"px-2","py-2","text-white","rounded-xl","transition-all","hover:bg-amber-400",3,"click"],[1,"flex","h-10","w-10","items-center","justify-center","rounded-lg","bg-indigo-100","text-indigo-800","dark:bg-indigo-600","dark:text-indigo-50"],[1,"text-2xl",3,"svgIcon"],["aria-label","Search by Name",1,"px-2","py-2","text-white","rounded-xl","transition-all","hover:bg-amber-400",3,"click"],["aria-label","Refresh Filters","title","Clear filters and reload",1,"px-2","py-2","text-white","rounded-xl","transition-all","hover:bg-amber-400","bg-gray-300",3,"click"],["svgIcon","mat_outline:refresh",1,"text-2xl"],[1,"fuse-mat-dense","fuse-mat-rounded","min-w-64",3,"subscriptSizing"],["matPrefix","",1,"icon-size-5",3,"svgIcon"],["matInput","","autocomplete","off",3,"ngModelChange","keydown.enter","placeholder","ngModel"],["mat-flat-button","","color","primary",1,"ml-3",3,"click"],[1,"icon-size-4",3,"svgIcon"],[1,"ml-2"],[1,"example-table-container","bg-card","-mt-16","h-full","rounded-t-2xl","shadow","overflow-auto",2,"min-height","0"],[1,"flex","flex-col","flex-auto","sm:mb-18","overflow-auto"],["mat-table","","matSort","",1,"w-full","table-fixed","border-separate","border-spacing-y-2",3,"dataSource"],["matColumnDef","code"],["mat-header-cell","","mat-sort-header","","class","px-4 py-3 text-left font-semibold",4,"matHeaderCellDef"],["mat-cell","","class","px-4 py-2",4,"matCellDef"],["matColumnDef","parentName"],["matColumnDef","id"],["matColumnDef","vehicleOwnerName"],["matColumnDef","action"],["mat-header-cell","","class","px-4 py-3 text-left font-semibold",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],[3,"page","length","pageSize","pageIndex","pageSizeOptions"],["mat-header-cell","","mat-sort-header","",1,"px-4","py-3","text-left","font-semibold"],["mat-cell","",1,"px-4","py-2"],[4,"ngIf","ngIfElse"],["type","text",1,"w-full","px-2","py-1","border","border-gray-300","rounded-md",3,"ngModelChange","ngModel"],["mat-header-cell","",1,"px-4","py-3","text-left","font-semibold"],[1,"flex","space-x-2"],["mat-flat-button","","class","fuse-mat-button-large","color","accent",3,"click",4,"ngIf"],["mat-flat-button","","class","fuse-mat-button-large","color","warn",3,"click",4,"ngIf"],["mat-flat-button","","color","warn",1,"fuse-mat-button-large",3,"click"],["mat-flat-button","","color","accent",1,"fuse-mat-button-large",3,"click"],["mat-header-row",""],["mat-row",""]],template:function(t,i){t&1&&(n(0,"div",2)(1,"div",3)(2,"div",4)(3,"h2",5),m(4," Category "),r()(),n(5,"div",6)(6,"div",7)(7,"button",8),u("click",function(){return i.searchByCode=!0}),n(8,"div",9),d(9,"mat-icon",10),r()(),n(10,"button",11),u("click",function(){return i.searchByCode=!1}),n(11,"div",9),d(12,"mat-icon",10),r()(),n(13,"button",12),u("click",function(){return i.refreshFilters()}),n(14,"div",9),d(15,"mat-icon",13),r()()(),n(16,"mat-form-field",14),d(17,"mat-icon",15),n(18,"input",16),u("ngModelChange",function(b){return i.searchByCode?i.filter.code=b:i.filter.name=b})("keydown.enter",function(){return i.loadSuppliers()}),r()(),n(19,"button",17),u("click",function(){return i.onFilterChange()}),d(20,"mat-icon",18),n(21,"span",19),m(22,"Search"),r()(),n(23,"button",17),u("click",function(){return i.openVehicleCreateDialog()}),d(24,"mat-icon",18),n(25,"span",19),m(26,"Create"),r()()()(),n(27,"div",20)(28,"div",21)(29,"table",22),y(30,23),f(31,nt,2,0,"th",24)(32,lt,4,2,"td",25),x(),y(33,26),f(34,st,2,0,"th",24)(35,mt,2,1,"td",25),x(),y(36,27),f(37,pt,2,0,"th",24)(38,ct,2,1,"td",25),x(),y(39,28),f(40,dt,2,0,"th",24)(41,gt,4,2,"td",25),x(),y(42,29),f(43,ht,1,0,"th",30)(44,yt,6,2,"td",25),x(),f(45,xt,1,0,"tr",31)(46,St,1,0,"tr",32),r()()(),n(47,"mat-paginator",33),u("page",function(b){return i.onPaginateChange(b)}),r()()),t&2&&(l(7),H("bg-amber-400",i.searchByCode)("bg-gray-300",!i.searchByCode),l(2),p("svgIcon","mat_outline:qr_code_scanner"),l(),H("bg-amber-400",!i.searchByCode)("bg-gray-300",i.searchByCode),l(2),p("svgIcon","heroicons_outline:user-circle"),l(4),p("subscriptSizing","dynamic"),l(),p("svgIcon",i.searchByCode?"mat_outline:qr_code_scanner":"heroicons_solid:magnifying-glass"),l(),p("placeholder",i.searchByCode?"Search by Fullpath":"Search by Name")("ngModel",i.searchByCode?i.filter.code:i.filter.name),l(2),p("svgIcon","heroicons_mini:magnifying-glass"),l(4),p("svgIcon","heroicons_mini:plus"),l(5),p("dataSource",i.supplier),l(16),p("matHeaderRowDef",i.displayedColumns),l(),p("matRowDefColumns",i.displayedColumns),l(),p("length",i.totalItems)("pageSize",i.pageSize)("pageIndex",i.currentPage-1)("pageSizeOptions",Z(23,ot)))},dependencies:[I,oe,V,B,R,ge,re,Ae,O,Ne,Ie,ke,De,Ee,Pe,Be,Fe,Te,Re,Ve,k,P,de,A,N,j,F,E,Oe,D,T],encapsulation:2})}}return o})();var hi=[{path:"",component:Ge,children:[]}];export{hi as default};
