import"./chunk-ZFENGWEO.js";import"./chunk-PMESUWSZ.js";import"./chunk-FKDMVCKV.js";import"./chunk-7RWLPLTW.js";import"./chunk-GTGBE7YF.js";import"./chunk-7KFYK36W.js";import{c as Ee}from"./chunk-XGCX3TDA.js";import{a as se,b as le,c as ce,d as pe,e as de,f as ue,g as fe,h as he,i as _e,j as Ce,k as be,l as ve}from"./chunk-4HPTI4QK.js";import{a as E,b as re,c as me}from"./chunk-Z5CSESBH.js";import{a as x,b as ge}from"./chunk-4IV6I57G.js";import{a as Me}from"./chunk-M5AHF4UO.js";import{a as ne}from"./chunk-CI6T4FGN.js";import{b as xe}from"./chunk-T73PE35A.js";import"./chunk-RHLCCWT6.js";import{h as Se}from"./chunk-ZGGKBBB7.js";import{a as ae}from"./chunk-E4TC4E2W.js";import"./chunk-YEGTZ3HQ.js";import"./chunk-QJXHZJQJ.js";import"./chunk-NKWJDJWK.js";import"./chunk-3N5N6CVQ.js";import{a as X}from"./chunk-QQNGDF4M.js";import"./chunk-YK5MGRE7.js";import{b as G}from"./chunk-OT3AQSDR.js";import"./chunk-2V7PXVXU.js";import"./chunk-4WAQRQWE.js";import"./chunk-KKTU7MAV.js";import"./chunk-5RBAZJQA.js";import"./chunk-LMUZFXJ5.js";import"./chunk-6F4FOUKE.js";import{J as ee,K as te,O as ie,P as oe,d as B,i as Q,j as q,l as K,q as W,u as Y,z as Z}from"./chunk-MXRUEL7B.js";import{b as J,c as U}from"./chunk-PNSBUHWU.js";import"./chunk-GRVU3NMS.js";import"./chunk-V44XL57R.js";import{c as H,g as O}from"./chunk-TEYA6QDP.js";import"./chunk-JTAP5U5F.js";import{a as j,d as L}from"./chunk-VPJKTFM7.js";import"./chunk-GXFYRQIF.js";import"./chunk-T4I3R2GV.js";import{d as V,e as $}from"./chunk-DJWEABC6.js";import{r as P}from"./chunk-MZLVPJ5Q.js";import{Aa as M,Bc as r,Db as z,Dc as _,E as F,H as R,Jc as k,Kb as p,Tb as c,ca as b,cc as o,dc as a,ea as v,ec as h,fc as d,gc as u,ic as N,m as A,nb as m,oa as f,oc as w,qc as y,uc as D,vc as I,wc as T,za as S}from"./chunk-2GFQMTJ2.js";var ye=()=>["/create-estimates"],De=()=>[5,10,20];function Ie(e,i){e&1&&(o(0,"th",29),r(1," ID "),a())}function Te(e,i){if(e&1&&(o(0,"td",30),r(1),a()),e&2){let t=i.$implicit;m(),_(" ",t.id," ")}}function ke(e,i){e&1&&(o(0,"th",29),r(1," Estimate Number "),a())}function Ae(e,i){if(e&1&&(o(0,"td",30),r(1),a()),e&2){let t=i.$implicit;m(),_(" ",t.estimateID," ")}}function Fe(e,i){e&1&&(o(0,"th",29),r(1," Vehicle "),a())}function Re(e,i){if(e&1&&(o(0,"td",30),r(1),a()),e&2){let t=i.$implicit;m(),_(" ",t.licenseNo," ")}}function ze(e,i){e&1&&(o(0,"th",29),r(1," Owner Name "),a())}function Ne(e,i){if(e&1&&(o(0,"td",30),r(1),a()),e&2){let t=i.$implicit;m(),_(" ",t.vehicleOwnerName," ")}}function Pe(e,i){e&1&&(o(0,"th",29),r(1," Service Advisor "),a())}function Ve(e,i){if(e&1&&(o(0,"td",30),r(1),a()),e&2){let t=i.$implicit;m(),_(" ",t.serviceAdvisor," ")}}function $e(e,i){e&1&&(o(0,"th",29),r(1," Vehicle Model "),a())}function He(e,i){if(e&1&&(o(0,"td",30),r(1),a()),e&2){let t=i.$implicit;m(),_(" ",t.vehicleModel," ")}}function Oe(e,i){e&1&&h(0,"th",31)}function Be(e,i){if(e&1){let t=N();o(0,"td",30)(1,"button",32),w("click",function(){let n=S(t).$implicit,s=y();return M(s.openEstimateEdit(n.id))}),r(2," View "),a(),o(3,"button",33),w("click",function(){let n=S(t).$implicit,s=y();return M(s.deleteEstimate(n))}),r(4," Delete "),a()()}}function Qe(e,i){e&1&&h(0,"tr",34)}function qe(e,i){e&1&&h(0,"tr",35)}var we=(()=>{class e{constructor(){this.createEstimate=!1,this._fuseConfirmationService=f(X),this.estimateService=f(ne),this.router=f(V),this.dialog=f(H),this._estimateTreatmentService=f(Me),this._snackBarService=f(ae),this.dataSource=new ve([]),this.displayedColumns=["id","estimateID","vehicleID","vehicleOwnerName","ServiceAdvisorName","vehicleModel","action"],this.searchInputControl=new Y(""),this.totalItems=0,this.itemsPerPage=10,this._unsubscribeAll=new A}ngOnInit(){this.loadEstimates(),this.searchInputControl.valueChanges.pipe(b(this._unsubscribeAll),v(()=>{this.paginator.pageIndex=0,this.loadEstimates()})).subscribe()}ngAfterViewInit(){this.sort&&(this.sort.sortChange.subscribe(()=>this.paginator.pageIndex=0),R(this.sort.sortChange,this.paginator.page).pipe(v(()=>this.loadEstimates()),b(this._unsubscribeAll)).subscribe())}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}loadEstimates(){let t=this.paginator?.pageIndex??0,l=this.paginator?.pageSize??this.itemsPerPage,n=this.sort?.active??"createdDate",s=this.sort?.direction??"desc",g=this.searchInputControl.value??"";this.estimateService.query({page:t,size:l,sort:[`${n},${s}`],"estimateID.contains":g}).pipe(b(this._unsubscribeAll),v(C=>{this.totalItems=Number(C.headers.get("X-Total-Count")),this.dataSource.data=C.body??[]})).subscribe()}openEstimateEdit(t){console.log("Open edit dialog",t),this.router.navigate(["/view-estimate/",t])}deleteEstimate(t){this._fuseConfirmationService.open({title:"Delete Estimate",message:"Are you sure you want to delete this estimate? This action cannot be undone!",icon:{name:"heroicons_outline:exclamation-triangle",color:"warn"},actions:{confirm:{label:"Delete",color:"warn"}}}).afterClosed().subscribe(n=>{n==="confirmed"&&this._estimateTreatmentService.query({"estimateId.equals":t.id}).subscribe(s=>{if(s.body.length>0){let g=s.body.map(C=>this._estimateTreatmentService.delete(C.id));F(g).subscribe(C=>{C&&(this._snackBarService.open("Estimate deleted successfully!","Close",{duration:3e3}),this.estimateService.delete(t.id).subscribe(()=>{this.loadEstimates()}))})}else this.estimateService.delete(t.id).subscribe(()=>{this.loadEstimates()})})})}toggleCreateEstimate(){this.createEstimate=!this.createEstimate}static{this.\u0275fac=function(l){return new(l||e)}}static{this.\u0275cmp=z({type:e,selectors:[["app-estimates"]],viewQuery:function(l,n){if(l&1&&(D(x,5),D(E,5)),l&2){let s;I(s=T())&&(n.paginator=s.first),I(s=T())&&(n.sort=s.first)}},decls:42,vars:15,consts:[["paginator",""],[1,"absolute","inset-0","flex","min-w-0","flex-col","overflow-hidden"],[1,"bg-default","flex","flex-0","flex-col","p-6","pb-22","dark:bg-transparent","sm:flex-row","sm:items-center","sm:justify-between","sm:px-10","sm:pb-28","sm:pt-12"],[1,"min-w-0","flex-1"],[1,"mt-2"],[1,"truncate","text-3xl","font-extrabold","leading-7","tracking-tight","sm:leading-10","md:text-4xl"],[1,"mt-6","flex","shrink-0","items-center","sm:ml-4","sm:mt-0"],[1,"fuse-mat-dense","fuse-mat-rounded","min-w-64",3,"subscriptSizing"],["matPrefix","",1,"icon-size-5",3,"svgIcon"],["matInput","","placeholder","Search Estimates",3,"formControl","autocomplete"],["mat-flat-button","",1,"ml-3",3,"color","routerLink"],[1,"icon-size-4",3,"svgIcon"],[1,"ml-2"],[1,"example-table-container","bg-card","-mt-16","h-full","rounded-t-2xl","shadow","overflow-auto"],[1,"flex","flex-col","flex-auto","sm:mb-18","overflow-auto"],["mat-table","","matSort","",1,"w-full","table-fixed","border-separate","border-spacing-y-2","px-6",3,"dataSource"],["matColumnDef","id"],["mat-header-cell","","mat-sort-header","","class","px-4 py-3 text-left font-semibold",4,"matHeaderCellDef"],["mat-cell","","class","px-4 py-2",4,"matCellDef"],["matColumnDef","estimateID"],["matColumnDef","vehicleID"],["matColumnDef","vehicleOwnerName"],["matColumnDef","ServiceAdvisorName"],["matColumnDef","vehicleModel"],["matColumnDef","action"],["mat-header-cell","","class","px-4 py-3 text-left font-semibold",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["showFirstLastButtons","","aria-label","Select page of periodic elements",1,"bottom-0","justify-self-end",3,"length","pageSize","pageSizeOptions"],["mat-header-cell","","mat-sort-header","",1,"px-4","py-3","text-left","font-semibold"],["mat-cell","",1,"px-4","py-2"],["mat-header-cell","",1,"px-4","py-3","text-left","font-semibold"],["mat-flat-button","","color","primary",1,"fuse-mat-button-large","mr-2",3,"click"],["mat-flat-button","","color","warn",1,"fuse-mat-button-large",3,"click"],["mat-header-row",""],["mat-row",""]],template:function(l,n){l&1&&(o(0,"div",1)(1,"div",2)(2,"div",3)(3,"div",4)(4,"h2",5),r(5," Estimates "),a()()(),o(6,"div",6)(7,"mat-form-field",7),h(8,"mat-icon",8)(9,"input",9),a(),o(10,"button",10),h(11,"mat-icon",11),o(12,"span",12),r(13,"Create New Estimate"),a()()()(),o(14,"div",13)(15,"div",14)(16,"table",15),d(17,16),p(18,Ie,2,0,"th",17)(19,Te,2,1,"td",18),u(),d(20,19),p(21,ke,2,0,"th",17)(22,Ae,2,1,"td",18),u(),d(23,20),p(24,Fe,2,0,"th",17)(25,Re,2,1,"td",18),u(),d(26,21),p(27,ze,2,0,"th",17)(28,Ne,2,1,"td",18),u(),d(29,22),p(30,Pe,2,0,"th",17)(31,Ve,2,1,"td",18),u(),d(32,23),p(33,$e,2,0,"th",17)(34,He,2,1,"td",18),u(),d(35,24),p(36,Oe,1,0,"th",25)(37,Be,5,0,"td",18),u(),p(38,Qe,1,0,"tr",26)(39,qe,1,0,"tr",27),a()()(),h(40,"mat-paginator",28,0),a()),l&2&&(m(7),c("subscriptSizing","dynamic"),m(),c("svgIcon","heroicons_solid:magnifying-glass"),m(),c("formControl",n.searchInputControl)("autocomplete","off"),m(),c("color","primary")("routerLink",k(13,ye)),m(),c("svgIcon","heroicons_mini:plus"),m(5),c("dataSource",n.dataSource),m(22),c("matHeaderRowDef",n.displayedColumns),m(),c("matRowDefColumns",n.displayedColumns),m(),c("length",n.totalItems)("pageSize",n.itemsPerPage)("pageSizeOptions",k(14,De)))},dependencies:[P,U,J,L,j,me,E,re,O,ee,K,W,te,Z,be,se,ce,fe,pe,le,he,de,ue,_e,Ce,q,Q,B,oe,ie,Ee,ge,x,Se,xe,$,G],encapsulation:2})}}return e})();var It=[{path:"",component:we}];export{It as default};
