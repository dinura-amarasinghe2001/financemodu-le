<form
  *ngIf="!selectClient"
  [formGroup]="clientForm"
  (ngSubmit)="submitClient()"
  class="p-4 md:p-6 space-y-4 animate-fade-in"
>
  <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
    <mat-form-field appearance="outline" class="w-full">
      <mat-label>Name</mat-label>
      <input matInput formControlName="name" required />
    </mat-form-field>

    <mat-form-field appearance="outline" class="w-full">
      <mat-label>Email</mat-label>
      <input matInput formControlName="email" type="email" />
    </mat-form-field>

    <mat-form-field appearance="outline" class="w-full">
      <mat-label>Contact Number 1</mat-label>
      <input matInput formControlName="contactNumber1" required />
    </mat-form-field>

    <mat-form-field appearance="outline" class="w-full">
      <mat-label>Contact Number 2</mat-label>
      <input matInput formControlName="contactNumber2" />
    </mat-form-field>

    <mat-form-field appearance="outline" class="w-full">
      <mat-label>Address</mat-label>
      <input matInput formControlName="address" />
    </mat-form-field>

    <mat-form-field appearance="outline" class="w-full">
      <mat-label>City</mat-label>
      <input matInput formControlName="city" />
    </mat-form-field>

    <!-- <mat-form-field appearance="outline" class="w-full">
      <mat-label>Operations Unit ID</mat-label>
      <input matInput formControlName="opsUnitID" />
    </mat-form-field> -->

    <!-- <mat-form-field appearance="outline" class="w-full">
      <mat-label>Last Vehicle ID</mat-label>
      <input matInput formControlName="lastVehicleID" />
    </mat-form-field>

    <mat-form-field appearance="outline" class="w-full">
      <mat-label>Last Receipt ID</mat-label>
      <input matInput formControlName="lastReceiptID" />
    </mat-form-field> -->
  </div>

  <div class="flex justify-end gap-2 mt-4">
    <button mat-raised-button color="warn" type="button" (click)="cancel()">
      Cancel
    </button>
    <button
      mat-raised-button
      color="primary"
      type="submit"
      [disabled]="clientForm.invalid"
    >
      Save Client
    </button>

    <button
      *ngIf="isFromDashboard"
      mat-raised-button
      color="accent"
      type="button"
      (click)="toggleCLient()"
    >
      Change Client
    </button>
  </div>
</form>

<div *ngIf="selectClient" class="">
  <div class="flex items-center">
    <mat-icon
      (click)="toggleCLient()"
      class="icon-size-10 text-black cursor-pointer"
      [svgIcon]="'heroicons_outline:arrow-left'"
    ></mat-icon>

    <div class="px-2 py-1 text-white w-32">
      <span class="text-black text-lg font-medium">Current Client</span>
    </div>
    <div
      class="bg-red-400 rounded-lg px-2 py-1 text-white w-30"
      *ngFor="let client of allClientDetails"
    >
      <span class="text-white text-sm font-medium">{{ client.name }} </span>
    </div>
  </div>
  <div class="flex gap-3 mt-2">
    <!-- Autocomplete Input -->

    <mat-form-field appearance="outline" class="flex-1">
      <mat-label>Client</mat-label>
      <input
        type="text"
        matInput
        [formControl]="clientControl"
        [matAutocomplete]="autoClient"
        placeholder="Type to find Client"
      />
      <mat-autocomplete
        #autoClient="matAutocomplete"
        [displayWith]="displayClient"
        (optionSelected)="onSelectClient($event)"
      >
        <mat-option
          *ngFor="let client of filterdClients$ | async"
          [value]="client"
        >
          {{ client.name }}
        </mat-option>
      </mat-autocomplete>
    </mat-form-field>

    <!-- Button -->

    <div class="">
      <button
        *ngIf="isFromDashboard"
        class="px-4 py-4 bg-gradient-to-r from-yellow-500 to-amber-500 hover:from-yellow-600 hover:to-amber-600 rounded-lg shadow text-white flex items-center transition-all duration-200"
        (click)="toggleForm()"
      >
        <mat-icon
          class="icon-size-4 text-white"
          [svgIcon]="'heroicons_mini:plus'"
        ></mat-icon>
        <span class="ml-2">New</span>
      </button>
    </div>
  </div>

  <form
    *ngIf="newClient"
    [formGroup]="clientForm"
    (ngSubmit)="submitClient()"
    class="p-4 md:p-6 space-y-4 animate-fade-in"
  >
    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
      <mat-form-field appearance="outline" class="w-full">
        <mat-label>Name</mat-label>
        <input matInput formControlName="name" required />
      </mat-form-field>

      <mat-form-field appearance="outline" class="w-full">
        <mat-label>Email</mat-label>
        <input matInput formControlName="email" type="email" />
      </mat-form-field>

      <mat-form-field appearance="outline" class="w-full">
        <mat-label>Contact Number 1</mat-label>
        <input matInput formControlName="contactNumber1" required />
      </mat-form-field>

      <mat-form-field appearance="outline" class="w-full">
        <mat-label>Contact Number 2</mat-label>
        <input matInput formControlName="contactNumber2" />
      </mat-form-field>

      <mat-form-field appearance="outline" class="w-full">
        <mat-label>Address</mat-label>
        <input matInput formControlName="address" />
      </mat-form-field>

      <mat-form-field appearance="outline" class="w-full">
        <mat-label>City</mat-label>
        <input matInput formControlName="city" />
      </mat-form-field>

      <!-- <mat-form-field appearance="outline" class="w-full">
      <mat-label>Operations Unit ID</mat-label>
      <input matInput formControlName="opsUnitID" />
    </mat-form-field> -->

      <mat-form-field appearance="outline" class="w-full">
        <mat-label>Last Vehicle ID</mat-label>
        <input matInput formControlName="lastVehicleID" />
      </mat-form-field>

      <mat-form-field appearance="outline" class="w-full">
        <mat-label>Last Receipt ID</mat-label>
        <input matInput formControlName="lastReceiptID" />
      </mat-form-field>
    </div>
    <div class="flex justify-end gap-2 mt-4">
      <button mat-raised-button color="warn" type="button" (click)="cancel()">
        Cancel
      </button>
      <button
        mat-raised-button
        color="primary"
        type="submit"
        [disabled]="clientForm.invalid"
      >
        Save Client
      </button>
    </div>
  </form>
  <div class="flex justify-end gap-2 mt-4" *ngIf="!newClient">
    <button mat-raised-button color="warn" type="button" (click)="cancel()">
      Cancel
    </button>
    <button
      mat-raised-button
      color="primary"
      (click)="changeOwner()"
      [disabled]="clientForm.invalid"
    >
      Change Client
    </button>
  </div>
</div>
